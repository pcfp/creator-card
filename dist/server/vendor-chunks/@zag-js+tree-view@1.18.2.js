"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@zag-js+tree-view@1.18.2";
exports.ids = ["vendor-chunks/@zag-js+tree-view@1.18.2"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/@zag-js+tree-view@1.18.2/node_modules/@zag-js/tree-view/dist/index.mjs":
/*!***************************************************************************************************!*\
  !*** ./node_modules/.pnpm/@zag-js+tree-view@1.18.2/node_modules/@zag-js/tree-view/dist/index.mjs ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   anatomy: () => (/* binding */ anatomy),\n/* harmony export */   collection: () => (/* binding */ collection),\n/* harmony export */   connect: () => (/* binding */ connect),\n/* harmony export */   filePathCollection: () => (/* binding */ filePathCollection),\n/* harmony export */   itemProps: () => (/* binding */ itemProps),\n/* harmony export */   machine: () => (/* binding */ machine),\n/* harmony export */   props: () => (/* binding */ props),\n/* harmony export */   splitItemProps: () => (/* binding */ splitItemProps),\n/* harmony export */   splitProps: () => (/* binding */ splitProps)\n/* harmony export */ });\n/* harmony import */ var _zag_js_anatomy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @zag-js/anatomy */ \"(ssr)/./node_modules/.pnpm/@zag-js+anatomy@1.18.2/node_modules/@zag-js/anatomy/dist/index.mjs\");\n/* harmony import */ var _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @zag-js/collection */ \"(ssr)/./node_modules/.pnpm/@zag-js+collection@1.18.2/node_modules/@zag-js/collection/dist/index.mjs\");\n/* harmony import */ var _zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @zag-js/dom-query */ \"(ssr)/./node_modules/.pnpm/@zag-js+dom-query@1.18.2/node_modules/@zag-js/dom-query/dist/index.mjs\");\n/* harmony import */ var _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @zag-js/utils */ \"(ssr)/./node_modules/.pnpm/@zag-js+utils@1.18.2/node_modules/@zag-js/utils/dist/index.mjs\");\n/* harmony import */ var _zag_js_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @zag-js/core */ \"(ssr)/./node_modules/.pnpm/@zag-js+core@1.18.2/node_modules/@zag-js/core/dist/index.mjs\");\n/* harmony import */ var _zag_js_types__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @zag-js/types */ \"(ssr)/./node_modules/.pnpm/@zag-js+types@1.18.2/node_modules/@zag-js/types/dist/index.mjs\");\n\n\n\n\n\n\n\n// src/tree-view.anatomy.ts\nvar anatomy = (0,_zag_js_anatomy__WEBPACK_IMPORTED_MODULE_0__.createAnatomy)(\"tree-view\").parts(\n  \"branch\",\n  \"branchContent\",\n  \"branchControl\",\n  \"branchIndentGuide\",\n  \"branchIndicator\",\n  \"branchText\",\n  \"branchTrigger\",\n  \"item\",\n  \"itemIndicator\",\n  \"itemText\",\n  \"label\",\n  \"nodeCheckbox\",\n  \"root\",\n  \"tree\"\n);\nvar parts = anatomy.build();\nvar collection = (options) => {\n  return new _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.TreeCollection(options);\n};\ncollection.empty = () => {\n  return new _zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.TreeCollection({ rootNode: { children: [] } });\n};\nfunction filePathCollection(paths) {\n  return (0,_zag_js_collection__WEBPACK_IMPORTED_MODULE_1__.filePathToTree)(paths);\n}\n\n// src/tree-view.dom.ts\nvar getRootId = (ctx) => ctx.ids?.root ?? `tree:${ctx.id}:root`;\nvar getLabelId = (ctx) => ctx.ids?.label ?? `tree:${ctx.id}:label`;\nvar getNodeId = (ctx, value) => ctx.ids?.node?.(value) ?? `tree:${ctx.id}:node:${value}`;\nvar getTreeId = (ctx) => ctx.ids?.tree ?? `tree:${ctx.id}:tree`;\nvar focusNode = (ctx, value) => {\n  if (value == null) return;\n  const nodeId = getNodeId(ctx, value);\n  ctx.getById(nodeId)?.focus({ preventScroll: true });\n};\nfunction getCheckedState(collection2, node, checkedValue) {\n  const value = collection2.getNodeValue(node);\n  if (!collection2.isBranchNode(node)) {\n    return checkedValue.includes(value);\n  }\n  const childValues = collection2.getDescendantValues(value);\n  const allChecked = childValues.every((v) => checkedValue.includes(v));\n  const someChecked = childValues.some((v) => checkedValue.includes(v));\n  return allChecked ? true : someChecked ? \"indeterminate\" : false;\n}\nfunction toggleBranchChecked(collection2, value, checkedValue) {\n  const childValues = collection2.getDescendantValues(value);\n  const allChecked = childValues.every((child) => checkedValue.includes(child));\n  return (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(allChecked ? (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(checkedValue, ...childValues) : (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(checkedValue, ...childValues));\n}\nfunction getCheckedValueMap(collection2, checkedValue) {\n  const map = /* @__PURE__ */ new Map();\n  collection2.visit({\n    onEnter: (node) => {\n      const value = collection2.getNodeValue(node);\n      const isBranch = collection2.isBranchNode(node);\n      const checked = getCheckedState(collection2, node, checkedValue);\n      map.set(value, {\n        type: isBranch ? \"branch\" : \"leaf\",\n        checked\n      });\n    }\n  });\n  return map;\n}\n\n// src/tree-view.connect.ts\nfunction connect(service, normalize) {\n  const { context, scope, computed, prop, send } = service;\n  const collection2 = prop(\"collection\");\n  const expandedValue = Array.from(context.get(\"expandedValue\"));\n  const selectedValue = Array.from(context.get(\"selectedValue\"));\n  const checkedValue = Array.from(context.get(\"checkedValue\"));\n  const isTypingAhead = computed(\"isTypingAhead\");\n  const focusedValue = context.get(\"focusedValue\");\n  const loadingStatus = context.get(\"loadingStatus\");\n  function getNodeState(props2) {\n    const { node, indexPath } = props2;\n    const value = collection2.getNodeValue(node);\n    const firstNode = collection2.getFirstNode();\n    const firstNodeValue = firstNode ? collection2.getNodeValue(firstNode) : null;\n    return {\n      id: getNodeId(scope, value),\n      value,\n      indexPath,\n      valuePath: collection2.getValuePath(indexPath),\n      disabled: Boolean(node.disabled),\n      focused: focusedValue == null ? firstNodeValue == value : focusedValue === value,\n      selected: selectedValue.includes(value),\n      expanded: expandedValue.includes(value),\n      loading: loadingStatus[value] === \"loading\",\n      depth: indexPath.length,\n      isBranch: collection2.isBranchNode(node),\n      get checked() {\n        return getCheckedState(collection2, node, checkedValue);\n      }\n    };\n  }\n  return {\n    collection: collection2,\n    expandedValue,\n    selectedValue,\n    checkedValue,\n    toggleChecked(value, isBranch) {\n      send({ type: \"CHECKED.TOGGLE\", value, isBranch });\n    },\n    setChecked(value) {\n      send({ type: \"CHECKED.SET\", value });\n    },\n    clearChecked() {\n      send({ type: \"CHECKED.CLEAR\" });\n    },\n    getCheckedMap() {\n      return getCheckedValueMap(collection2, checkedValue);\n    },\n    expand(value) {\n      send({ type: value ? \"BRANCH.EXPAND\" : \"EXPANDED.ALL\", value });\n    },\n    collapse(value) {\n      send({ type: value ? \"BRANCH.COLLAPSE\" : \"EXPANDED.CLEAR\", value });\n    },\n    deselect(value) {\n      send({ type: value ? \"NODE.DESELECT\" : \"SELECTED.CLEAR\", value });\n    },\n    select(value) {\n      send({ type: value ? \"NODE.SELECT\" : \"SELECTED.ALL\", value, isTrusted: false });\n    },\n    getVisibleNodes() {\n      return computed(\"visibleNodes\").map(({ node }) => node);\n    },\n    focus(value) {\n      focusNode(scope, value);\n    },\n    selectParent(value) {\n      const parentNode = collection2.getParentNode(value);\n      if (!parentNode) return;\n      const _selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(selectedValue, collection2.getNodeValue(parentNode));\n      send({ type: \"SELECTED.SET\", value: _selectedValue, src: \"select.parent\" });\n    },\n    expandParent(value) {\n      const parentNode = collection2.getParentNode(value);\n      if (!parentNode) return;\n      const _expandedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(expandedValue, collection2.getNodeValue(parentNode));\n      send({ type: \"EXPANDED.SET\", value: _expandedValue, src: \"expand.parent\" });\n    },\n    setExpandedValue(value) {\n      const _expandedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(value);\n      send({ type: \"EXPANDED.SET\", value: _expandedValue });\n    },\n    setSelectedValue(value) {\n      const _selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(value);\n      send({ type: \"SELECTED.SET\", value: _selectedValue });\n    },\n    getRootProps() {\n      return normalize.element({\n        ...parts.root.attrs,\n        id: getRootId(scope),\n        dir: prop(\"dir\")\n      });\n    },\n    getLabelProps() {\n      return normalize.element({\n        ...parts.label.attrs,\n        id: getLabelId(scope),\n        dir: prop(\"dir\")\n      });\n    },\n    getTreeProps() {\n      return normalize.element({\n        ...parts.tree.attrs,\n        id: getTreeId(scope),\n        dir: prop(\"dir\"),\n        role: \"tree\",\n        \"aria-label\": \"Tree View\",\n        \"aria-labelledby\": getLabelId(scope),\n        \"aria-multiselectable\": prop(\"selectionMode\") === \"multiple\" || void 0,\n        tabIndex: -1,\n        onKeyDown(event) {\n          if (event.defaultPrevented) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isComposingEvent)(event)) return;\n          const target = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getEventTarget)(event);\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isEditableElement)(target)) return;\n          const node = target?.closest(\"[data-part=branch-control], [data-part=item]\");\n          if (!node) return;\n          const nodeId = node.dataset.value;\n          if (nodeId == null) {\n            console.warn(`[zag-js/tree-view] Node id not found for node`, node);\n            return;\n          }\n          const isBranchNode = node.matches(\"[data-part=branch-control]\");\n          const keyMap = {\n            ArrowDown(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.ARROW_DOWN\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            ArrowUp(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.ARROW_UP\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            ArrowLeft(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2) || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: isBranchNode ? \"BRANCH_NODE.ARROW_LEFT\" : \"NODE.ARROW_LEFT\", id: nodeId });\n            },\n            ArrowRight(event2) {\n              if (!isBranchNode || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"BRANCH_NODE.ARROW_RIGHT\", id: nodeId });\n            },\n            Home(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.HOME\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            End(event2) {\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              event2.preventDefault();\n              send({ type: \"NODE.END\", id: nodeId, shiftKey: event2.shiftKey });\n            },\n            Space(event2) {\n              if (node.dataset.disabled) return;\n              if (isTypingAhead) {\n                send({ type: \"TREE.TYPEAHEAD\", key: event2.key });\n              } else {\n                keyMap.Enter?.(event2);\n              }\n            },\n            Enter(event2) {\n              if (node.dataset.disabled) return;\n              if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(target) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event2)) return;\n              send({ type: isBranchNode ? \"BRANCH_NODE.CLICK\" : \"NODE.CLICK\", id: nodeId, src: \"keyboard\" });\n              if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(target)) {\n                event2.preventDefault();\n              }\n            },\n            \"*\"(event2) {\n              if (node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"SIBLINGS.EXPAND\", id: nodeId });\n            },\n            a(event2) {\n              if (!event2.metaKey || node.dataset.disabled) return;\n              event2.preventDefault();\n              send({ type: \"SELECTED.ALL\", moveFocus: true });\n            }\n          };\n          const key = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getEventKey)(event, { dir: prop(\"dir\") });\n          const exec = keyMap[key];\n          if (exec) {\n            exec(event);\n            return;\n          }\n          if (!_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead.isValidEvent(event)) return;\n          send({ type: \"TREE.TYPEAHEAD\", key: event.key, id: nodeId });\n          event.preventDefault();\n        }\n      });\n    },\n    getNodeState,\n    getItemProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.item.attrs,\n        id: nodeState.id,\n        dir: prop(\"dir\"),\n        \"data-ownedby\": getTreeId(scope),\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-value\": nodeState.value,\n        tabIndex: nodeState.focused ? 0 : -1,\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        role: \"treeitem\",\n        \"aria-current\": nodeState.selected ? \"true\" : void 0,\n        \"aria-selected\": nodeState.disabled ? void 0 : nodeState.selected,\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"aria-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.disabled),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"aria-level\": nodeState.depth,\n        \"data-depth\": nodeState.depth,\n        style: {\n          \"--depth\": nodeState.depth\n        },\n        onFocus(event) {\n          event.stopPropagation();\n          send({ type: \"NODE.FOCUS\", id: nodeState.value });\n        },\n        onClick(event) {\n          if (nodeState.disabled) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event)) return;\n          const isMetaKey = event.metaKey || event.ctrlKey;\n          send({ type: \"NODE.CLICK\", id: nodeState.value, shiftKey: event.shiftKey, ctrlKey: isMetaKey });\n          event.stopPropagation();\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget)) {\n            event.preventDefault();\n          }\n        }\n      });\n    },\n    getItemTextProps(props2) {\n      const itemState = getNodeState(props2);\n      return normalize.element({\n        ...parts.itemText.attrs,\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.focused)\n      });\n    },\n    getItemIndicatorProps(props2) {\n      const itemState = getNodeState(props2);\n      return normalize.element({\n        ...parts.itemIndicator.attrs,\n        \"aria-hidden\": true,\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(itemState.focused),\n        hidden: !itemState.selected\n      });\n    },\n    getBranchProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branch.attrs,\n        \"data-depth\": nodeState.depth,\n        dir: prop(\"dir\"),\n        \"data-branch\": nodeState.value,\n        role: \"treeitem\",\n        \"data-ownedby\": getTreeId(scope),\n        \"data-value\": nodeState.value,\n        \"aria-level\": nodeState.depth,\n        \"aria-selected\": nodeState.disabled ? void 0 : nodeState.selected,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"aria-expanded\": nodeState.expanded,\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"aria-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.disabled),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        \"aria-busy\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.loading),\n        style: {\n          \"--depth\": nodeState.depth\n        }\n      });\n    },\n    getBranchIndicatorProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchIndicator.attrs,\n        \"aria-hidden\": true,\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading)\n      });\n    },\n    getBranchTriggerProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchTrigger.attrs,\n        role: \"button\",\n        dir: prop(\"dir\"),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-value\": nodeState.value,\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        disabled: nodeState.loading,\n        onClick(event) {\n          if (nodeState.disabled || nodeState.loading) return;\n          send({ type: \"BRANCH_TOGGLE.CLICK\", id: nodeState.value });\n          event.stopPropagation();\n        }\n      });\n    },\n    getBranchControlProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchControl.attrs,\n        role: \"button\",\n        id: nodeState.id,\n        dir: prop(\"dir\"),\n        tabIndex: nodeState.focused ? 0 : -1,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-selected\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.selected),\n        \"data-focus\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.focused),\n        \"data-value\": nodeState.value,\n        \"data-depth\": nodeState.depth,\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading),\n        \"aria-busy\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.ariaAttr)(nodeState.loading),\n        onFocus(event) {\n          send({ type: \"NODE.FOCUS\", id: nodeState.value });\n          event.stopPropagation();\n        },\n        onClick(event) {\n          if (nodeState.disabled) return;\n          if (nodeState.loading) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          if ((0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isAnchorElement)(event.currentTarget) && (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isModifierKey)(event)) return;\n          const isMetaKey = event.metaKey || event.ctrlKey;\n          send({ type: \"BRANCH_NODE.CLICK\", id: nodeState.value, shiftKey: event.shiftKey, ctrlKey: isMetaKey });\n          event.stopPropagation();\n        }\n      });\n    },\n    getBranchTextProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchText.attrs,\n        dir: prop(\"dir\"),\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-loading\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.loading)\n      });\n    },\n    getBranchContentProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchContent.attrs,\n        role: \"group\",\n        dir: prop(\"dir\"),\n        \"data-state\": nodeState.expanded ? \"open\" : \"closed\",\n        \"data-depth\": nodeState.depth,\n        \"data-path\": props2.indexPath.join(\"/\"),\n        \"data-value\": nodeState.value,\n        hidden: !nodeState.expanded\n      });\n    },\n    getBranchIndentGuideProps(props2) {\n      const nodeState = getNodeState(props2);\n      return normalize.element({\n        ...parts.branchIndentGuide.attrs,\n        \"data-depth\": nodeState.depth\n      });\n    },\n    getNodeCheckboxProps(props2) {\n      const nodeState = getNodeState(props2);\n      const checkedState = nodeState.checked;\n      return normalize.element({\n        ...parts.nodeCheckbox.attrs,\n        tabIndex: -1,\n        role: \"checkbox\",\n        \"data-state\": checkedState === true ? \"checked\" : checkedState === false ? \"unchecked\" : \"indeterminate\",\n        \"aria-checked\": checkedState === true ? \"true\" : checkedState === false ? \"false\" : \"mixed\",\n        \"data-disabled\": (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.dataAttr)(nodeState.disabled),\n        onClick(event) {\n          if (event.defaultPrevented) return;\n          if (nodeState.disabled) return;\n          if (!(0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.isLeftClick)(event)) return;\n          send({ type: \"CHECKED.TOGGLE\", value: nodeState.value, isBranch: nodeState.isBranch });\n          event.stopPropagation();\n          const node = event.currentTarget.closest(\"[role=treeitem]\");\n          node?.focus({ preventScroll: true });\n        }\n      });\n    }\n  };\n}\nfunction expandBranches(params, values) {\n  const { context, prop, refs } = params;\n  if (!prop(\"loadChildren\")) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...values)));\n    return;\n  }\n  const loadingStatus = context.get(\"loadingStatus\");\n  const [loadedValues, loadingValues] = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.partition)(values, (value) => loadingStatus[value] === \"loaded\");\n  if (loadedValues.length > 0) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...loadedValues)));\n  }\n  if (loadingValues.length === 0) return;\n  const collection2 = prop(\"collection\");\n  const [nodeWithChildren, nodeWithoutChildren] = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.partition)(loadingValues, (id) => {\n    const node = collection2.findNode(id);\n    return collection2.getNodeChildren(node).length > 0;\n  });\n  if (nodeWithChildren.length > 0) {\n    context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...nodeWithChildren)));\n  }\n  if (nodeWithoutChildren.length === 0) return;\n  context.set(\"loadingStatus\", (prev) => ({\n    ...prev,\n    ...nodeWithoutChildren.reduce((acc, id) => ({ ...acc, [id]: \"loading\" }), {})\n  }));\n  const nodesToLoad = nodeWithoutChildren.map((id) => {\n    const indexPath = collection2.getIndexPath(id);\n    const valuePath = collection2.getValuePath(indexPath);\n    const node = collection2.findNode(id);\n    return { id, indexPath, valuePath, node };\n  });\n  const pendingAborts = refs.get(\"pendingAborts\");\n  const loadChildren = prop(\"loadChildren\");\n  (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.ensure)(loadChildren, () => \"[zag-js/tree-view] `loadChildren` is required for async expansion\");\n  const proms = nodesToLoad.map(({ id, indexPath, valuePath, node }) => {\n    const existingAbort = pendingAborts.get(id);\n    if (existingAbort) {\n      existingAbort.abort();\n      pendingAborts.delete(id);\n    }\n    const abortController = new AbortController();\n    pendingAborts.set(id, abortController);\n    return loadChildren({\n      valuePath,\n      indexPath,\n      node,\n      signal: abortController.signal\n    });\n  });\n  Promise.allSettled(proms).then((results) => {\n    const loadedValues2 = [];\n    const nodeWithErrors = [];\n    const nextLoadingStatus = context.get(\"loadingStatus\");\n    let collection3 = prop(\"collection\");\n    results.forEach((result, index) => {\n      const { id, indexPath, node, valuePath } = nodesToLoad[index];\n      if (result.status === \"fulfilled\") {\n        nextLoadingStatus[id] = \"loaded\";\n        loadedValues2.push(id);\n        collection3 = collection3.replace(indexPath, { ...node, children: result.value });\n      } else {\n        pendingAborts.delete(id);\n        Reflect.deleteProperty(nextLoadingStatus, id);\n        nodeWithErrors.push({ node, error: result.reason, indexPath, valuePath });\n      }\n    });\n    context.set(\"loadingStatus\", nextLoadingStatus);\n    if (loadedValues2.length) {\n      context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)((0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.add)(prev, ...loadedValues2)));\n      prop(\"onLoadChildrenComplete\")?.({ collection: collection3 });\n    }\n    if (nodeWithErrors.length) {\n      prop(\"onLoadChildrenError\")?.({ nodes: nodeWithErrors });\n    }\n  });\n}\n\n// src/utils/visit-skip.ts\nfunction skipFn(params) {\n  const { prop, context } = params;\n  return function skip({ indexPath }) {\n    const paths = prop(\"collection\").getValuePath(indexPath).slice(0, -1);\n    return paths.some((value) => !context.get(\"expandedValue\").includes(value));\n  };\n}\n\n// src/tree-view.machine.ts\nvar { and } = (0,_zag_js_core__WEBPACK_IMPORTED_MODULE_4__.createGuards)();\nvar machine = (0,_zag_js_core__WEBPACK_IMPORTED_MODULE_4__.createMachine)({\n  props({ props: props2 }) {\n    return {\n      selectionMode: \"single\",\n      collection: collection.empty(),\n      typeahead: true,\n      expandOnClick: true,\n      defaultExpandedValue: [],\n      defaultSelectedValue: [],\n      ...props2\n    };\n  },\n  initialState() {\n    return \"idle\";\n  },\n  context({ prop, bindable, getContext }) {\n    return {\n      expandedValue: bindable(() => ({\n        defaultValue: prop(\"defaultExpandedValue\"),\n        value: prop(\"expandedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(expandedValue) {\n          const ctx = getContext();\n          const focusedValue = ctx.get(\"focusedValue\");\n          prop(\"onExpandedChange\")?.({\n            expandedValue,\n            focusedValue,\n            get expandedNodes() {\n              return prop(\"collection\").findNodes(expandedValue);\n            }\n          });\n        }\n      })),\n      selectedValue: bindable(() => ({\n        defaultValue: prop(\"defaultSelectedValue\"),\n        value: prop(\"selectedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(selectedValue) {\n          const ctx = getContext();\n          const focusedValue = ctx.get(\"focusedValue\");\n          prop(\"onSelectionChange\")?.({\n            selectedValue,\n            focusedValue,\n            get selectedNodes() {\n              return prop(\"collection\").findNodes(selectedValue);\n            }\n          });\n        }\n      })),\n      focusedValue: bindable(() => ({\n        defaultValue: prop(\"defaultFocusedValue\") || null,\n        value: prop(\"focusedValue\"),\n        onChange(focusedValue) {\n          prop(\"onFocusChange\")?.({\n            focusedValue,\n            get focusedNode() {\n              return focusedValue ? prop(\"collection\").findNode(focusedValue) : null;\n            }\n          });\n        }\n      })),\n      loadingStatus: bindable(() => ({\n        defaultValue: {}\n      })),\n      checkedValue: bindable(() => ({\n        defaultValue: prop(\"defaultCheckedValue\") || [],\n        value: prop(\"checkedValue\"),\n        isEqual: _zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isEqual,\n        onChange(value) {\n          prop(\"onCheckedChange\")?.({ checkedValue: value });\n        }\n      }))\n    };\n  },\n  refs() {\n    return {\n      typeaheadState: { ..._zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead.defaultOptions },\n      pendingAborts: /* @__PURE__ */ new Map()\n    };\n  },\n  computed: {\n    isMultipleSelection: ({ prop }) => prop(\"selectionMode\") === \"multiple\",\n    isTypingAhead: ({ refs }) => refs.get(\"typeaheadState\").keysSoFar.length > 0,\n    visibleNodes: ({ prop, context }) => {\n      const nodes = [];\n      prop(\"collection\").visit({\n        skip: skipFn({ prop, context }),\n        onEnter: (node, indexPath) => {\n          nodes.push({ node, indexPath });\n        }\n      });\n      return nodes;\n    }\n  },\n  on: {\n    \"EXPANDED.SET\": {\n      actions: [\"setExpanded\"]\n    },\n    \"EXPANDED.CLEAR\": {\n      actions: [\"clearExpanded\"]\n    },\n    \"EXPANDED.ALL\": {\n      actions: [\"expandAllBranches\"]\n    },\n    \"BRANCH.EXPAND\": {\n      actions: [\"expandBranches\"]\n    },\n    \"BRANCH.COLLAPSE\": {\n      actions: [\"collapseBranches\"]\n    },\n    \"SELECTED.SET\": {\n      actions: [\"setSelected\"]\n    },\n    \"SELECTED.ALL\": [\n      {\n        guard: and(\"isMultipleSelection\", \"moveFocus\"),\n        actions: [\"selectAllNodes\", \"focusTreeLastNode\"]\n      },\n      {\n        guard: \"isMultipleSelection\",\n        actions: [\"selectAllNodes\"]\n      }\n    ],\n    \"SELECTED.CLEAR\": {\n      actions: [\"clearSelected\"]\n    },\n    \"NODE.SELECT\": {\n      actions: [\"selectNode\"]\n    },\n    \"NODE.DESELECT\": {\n      actions: [\"deselectNode\"]\n    },\n    \"CHECKED.TOGGLE\": {\n      actions: [\"toggleChecked\"]\n    },\n    \"CHECKED.SET\": {\n      actions: [\"setChecked\"]\n    },\n    \"CHECKED.CLEAR\": {\n      actions: [\"clearChecked\"]\n    }\n  },\n  exit: [\"clearPendingAborts\"],\n  states: {\n    idle: {\n      on: {\n        \"NODE.FOCUS\": {\n          actions: [\"setFocusedNode\"]\n        },\n        \"NODE.ARROW_DOWN\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"focusTreeNextNode\", \"extendSelectionToNextNode\"]\n          },\n          {\n            actions: [\"focusTreeNextNode\"]\n          }\n        ],\n        \"NODE.ARROW_UP\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"focusTreePrevNode\", \"extendSelectionToPrevNode\"]\n          },\n          {\n            actions: [\"focusTreePrevNode\"]\n          }\n        ],\n        \"NODE.ARROW_LEFT\": {\n          actions: [\"focusBranchNode\"]\n        },\n        \"BRANCH_NODE.ARROW_LEFT\": [\n          {\n            guard: \"isBranchExpanded\",\n            actions: [\"collapseBranch\"]\n          },\n          {\n            actions: [\"focusBranchNode\"]\n          }\n        ],\n        \"BRANCH_NODE.ARROW_RIGHT\": [\n          {\n            guard: and(\"isBranchFocused\", \"isBranchExpanded\"),\n            actions: [\"focusBranchFirstNode\"]\n          },\n          {\n            actions: [\"expandBranch\"]\n          }\n        ],\n        \"SIBLINGS.EXPAND\": {\n          actions: [\"expandSiblingBranches\"]\n        },\n        \"NODE.HOME\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToFirstNode\", \"focusTreeFirstNode\"]\n          },\n          {\n            actions: [\"focusTreeFirstNode\"]\n          }\n        ],\n        \"NODE.END\": [\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToLastNode\", \"focusTreeLastNode\"]\n          },\n          {\n            actions: [\"focusTreeLastNode\"]\n          }\n        ],\n        \"NODE.CLICK\": [\n          {\n            guard: and(\"isCtrlKey\", \"isMultipleSelection\"),\n            actions: [\"toggleNodeSelection\"]\n          },\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToNode\"]\n          },\n          {\n            actions: [\"selectNode\"]\n          }\n        ],\n        \"BRANCH_NODE.CLICK\": [\n          {\n            guard: and(\"isCtrlKey\", \"isMultipleSelection\"),\n            actions: [\"toggleNodeSelection\"]\n          },\n          {\n            guard: and(\"isShiftKey\", \"isMultipleSelection\"),\n            actions: [\"extendSelectionToNode\"]\n          },\n          {\n            guard: \"expandOnClick\",\n            actions: [\"selectNode\", \"toggleBranchNode\"]\n          },\n          {\n            actions: [\"selectNode\"]\n          }\n        ],\n        \"BRANCH_TOGGLE.CLICK\": {\n          actions: [\"toggleBranchNode\"]\n        },\n        \"TREE.TYPEAHEAD\": {\n          actions: [\"focusMatchedNode\"]\n        }\n      }\n    }\n  },\n  implementations: {\n    guards: {\n      isBranchFocused: ({ context, event }) => context.get(\"focusedValue\") === event.id,\n      isBranchExpanded: ({ context, event }) => context.get(\"expandedValue\").includes(event.id),\n      isShiftKey: ({ event }) => event.shiftKey,\n      isCtrlKey: ({ event }) => event.ctrlKey,\n      hasSelectedItems: ({ context }) => context.get(\"selectedValue\").length > 0,\n      isMultipleSelection: ({ prop }) => prop(\"selectionMode\") === \"multiple\",\n      moveFocus: ({ event }) => !!event.moveFocus,\n      expandOnClick: ({ prop }) => !!prop(\"expandOnClick\")\n    },\n    actions: {\n      selectNode({ context, event }) {\n        const value = event.id || event.value;\n        context.set(\"selectedValue\", (prev) => {\n          if (value == null) return prev;\n          if (!event.isTrusted && (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(value)) return prev.concat(...value);\n          return [(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(value) ? (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.last)(value) : value].filter(Boolean);\n        });\n      },\n      deselectNode({ context, event }) {\n        const value = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.id || event.value);\n        context.set(\"selectedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, ...value));\n      },\n      setFocusedNode({ context, event }) {\n        context.set(\"focusedValue\", event.id);\n      },\n      clearFocusedNode({ context }) {\n        context.set(\"focusedValue\", null);\n      },\n      clearSelectedItem({ context }) {\n        context.set(\"selectedValue\", []);\n      },\n      toggleBranchNode({ context, event, action }) {\n        const isExpanded = context.get(\"expandedValue\").includes(event.id);\n        action(isExpanded ? [\"collapseBranch\"] : [\"expandBranch\"]);\n      },\n      expandBranch(params) {\n        const { event } = params;\n        expandBranches(params, [event.id]);\n      },\n      expandBranches(params) {\n        const { context, event } = params;\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.value);\n        expandBranches(params, (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(valuesToExpand, context.get(\"expandedValue\")));\n      },\n      collapseBranch({ context, event }) {\n        context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, event.id));\n      },\n      collapseBranches(params) {\n        const { context, event } = params;\n        const value = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.toArray)(event.value);\n        context.set(\"expandedValue\", (prev) => (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.remove)(prev, ...value));\n      },\n      setExpanded({ context, event }) {\n        if (!(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(event.value)) return;\n        context.set(\"expandedValue\", event.value);\n      },\n      clearExpanded({ context }) {\n        context.set(\"expandedValue\", []);\n      },\n      setSelected({ context, event }) {\n        if (!(0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.isArray)(event.value)) return;\n        context.set(\"selectedValue\", event.value);\n      },\n      clearSelected({ context }) {\n        context.set(\"selectedValue\", []);\n      },\n      focusTreeFirstNode({ prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const firstNode = collection2.getFirstNode();\n        const firstValue = collection2.getNodeValue(firstNode);\n        focusNode(scope, firstValue);\n      },\n      focusTreeLastNode(params) {\n        const { prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const lastNode = collection2.getLastNode(void 0, { skip: skipFn(params) });\n        const lastValue = collection2.getNodeValue(lastNode);\n        focusNode(scope, lastValue);\n      },\n      focusBranchFirstNode({ event, prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const branchNode = collection2.findNode(event.id);\n        const firstNode = collection2.getFirstNode(branchNode);\n        const firstValue = collection2.getNodeValue(firstNode);\n        focusNode(scope, firstValue);\n      },\n      focusTreeNextNode(params) {\n        const { event, prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const nextNode = collection2.getNextNode(event.id, { skip: skipFn(params) });\n        if (!nextNode) return;\n        const nextValue = collection2.getNodeValue(nextNode);\n        focusNode(scope, nextValue);\n      },\n      focusTreePrevNode(params) {\n        const { event, prop, scope } = params;\n        const collection2 = prop(\"collection\");\n        const prevNode = collection2.getPreviousNode(event.id, { skip: skipFn(params) });\n        if (!prevNode) return;\n        const prevValue = collection2.getNodeValue(prevNode);\n        focusNode(scope, prevValue);\n      },\n      focusBranchNode({ event, prop, scope }) {\n        const collection2 = prop(\"collection\");\n        const parentNode = collection2.getParentNode(event.id);\n        const parentValue = parentNode ? collection2.getNodeValue(parentNode) : void 0;\n        focusNode(scope, parentValue);\n      },\n      selectAllNodes({ context, prop }) {\n        context.set(\"selectedValue\", prop(\"collection\").getValues());\n      },\n      focusMatchedNode(params) {\n        const { context, prop, refs, event, scope, computed } = params;\n        const nodes = computed(\"visibleNodes\");\n        const elements = nodes.map(({ node: node2 }) => ({\n          textContent: prop(\"collection\").stringifyNode(node2),\n          id: prop(\"collection\").getNodeValue(node2)\n        }));\n        const node = (0,_zag_js_dom_query__WEBPACK_IMPORTED_MODULE_3__.getByTypeahead)(elements, {\n          state: refs.get(\"typeaheadState\"),\n          activeId: context.get(\"focusedValue\"),\n          key: event.key\n        });\n        focusNode(scope, node?.id);\n      },\n      toggleNodeSelection({ context, event }) {\n        const selectedValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.addOrRemove)(context.get(\"selectedValue\"), event.id);\n        context.set(\"selectedValue\", selectedValue);\n      },\n      expandAllBranches(params) {\n        const { context, prop } = params;\n        const branchValues = prop(\"collection\").getBranchValues();\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(branchValues, context.get(\"expandedValue\"));\n        expandBranches(params, valuesToExpand);\n      },\n      expandSiblingBranches(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const indexPath = collection2.getIndexPath(event.id);\n        if (!indexPath) return;\n        const nodes = collection2.getSiblingNodes(indexPath);\n        const values = nodes.map((node) => collection2.getNodeValue(node));\n        const valuesToExpand = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.diff)(values, context.get(\"expandedValue\"));\n        expandBranches(params, valuesToExpand);\n      },\n      extendSelectionToNode(params) {\n        const { context, event, prop, computed } = params;\n        const collection2 = prop(\"collection\");\n        const anchorValue = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\")) || collection2.getNodeValue(collection2.getFirstNode());\n        const targetValue = event.id;\n        let values = [anchorValue, targetValue];\n        let hits = 0;\n        const visibleNodes = computed(\"visibleNodes\");\n        visibleNodes.forEach(({ node }) => {\n          const nodeValue = collection2.getNodeValue(node);\n          if (hits === 1) values.push(nodeValue);\n          if (nodeValue === anchorValue || nodeValue === targetValue) hits++;\n        });\n        context.set(\"selectedValue\", (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.uniq)(values));\n      },\n      extendSelectionToNextNode(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const nextNode = collection2.getNextNode(event.id, { skip: skipFn(params) });\n        if (!nextNode) return;\n        const values = new Set(context.get(\"selectedValue\"));\n        const nextValue = collection2.getNodeValue(nextNode);\n        if (nextValue == null) return;\n        if (values.has(event.id) && values.has(nextValue)) {\n          values.delete(event.id);\n        } else if (!values.has(nextValue)) {\n          values.add(nextValue);\n        }\n        context.set(\"selectedValue\", Array.from(values));\n      },\n      extendSelectionToPrevNode(params) {\n        const { context, event, prop } = params;\n        const collection2 = prop(\"collection\");\n        const prevNode = collection2.getPreviousNode(event.id, { skip: skipFn(params) });\n        if (!prevNode) return;\n        const values = new Set(context.get(\"selectedValue\"));\n        const prevValue = collection2.getNodeValue(prevNode);\n        if (prevValue == null) return;\n        if (values.has(event.id) && values.has(prevValue)) {\n          values.delete(event.id);\n        } else if (!values.has(prevValue)) {\n          values.add(prevValue);\n        }\n        context.set(\"selectedValue\", Array.from(values));\n      },\n      extendSelectionToFirstNode(params) {\n        const { context, prop } = params;\n        const collection2 = prop(\"collection\");\n        const currentSelection = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\"));\n        const values = [];\n        collection2.visit({\n          skip: skipFn(params),\n          onEnter: (node) => {\n            const nodeValue = collection2.getNodeValue(node);\n            values.push(nodeValue);\n            if (nodeValue === currentSelection) {\n              return \"stop\";\n            }\n          }\n        });\n        context.set(\"selectedValue\", values);\n      },\n      extendSelectionToLastNode(params) {\n        const { context, prop } = params;\n        const collection2 = prop(\"collection\");\n        const currentSelection = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.first)(context.get(\"selectedValue\"));\n        const values = [];\n        let current = false;\n        collection2.visit({\n          skip: skipFn(params),\n          onEnter: (node) => {\n            const nodeValue = collection2.getNodeValue(node);\n            if (nodeValue === currentSelection) current = true;\n            if (current) values.push(nodeValue);\n          }\n        });\n        context.set(\"selectedValue\", values);\n      },\n      clearPendingAborts({ refs }) {\n        const aborts = refs.get(\"pendingAborts\");\n        aborts.forEach((abort) => abort.abort());\n        aborts.clear();\n      },\n      toggleChecked({ context, event, prop }) {\n        const collection2 = prop(\"collection\");\n        context.set(\n          \"checkedValue\",\n          (prev) => event.isBranch ? toggleBranchChecked(collection2, event.value, prev) : (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.addOrRemove)(prev, event.value)\n        );\n      },\n      setChecked({ context, event }) {\n        context.set(\"checkedValue\", event.value);\n      },\n      clearChecked({ context }) {\n        context.set(\"checkedValue\", []);\n      }\n    }\n  }\n});\nvar props = (0,_zag_js_types__WEBPACK_IMPORTED_MODULE_5__.createProps)()([\n  \"ids\",\n  \"collection\",\n  \"dir\",\n  \"expandedValue\",\n  \"expandOnClick\",\n  \"defaultFocusedValue\",\n  \"focusedValue\",\n  \"getRootNode\",\n  \"id\",\n  \"onExpandedChange\",\n  \"onFocusChange\",\n  \"onSelectionChange\",\n  \"checkedValue\",\n  \"selectedValue\",\n  \"selectionMode\",\n  \"typeahead\",\n  \"defaultExpandedValue\",\n  \"defaultSelectedValue\",\n  \"defaultCheckedValue\",\n  \"onCheckedChange\",\n  \"onLoadChildrenComplete\",\n  \"onLoadChildrenError\",\n  \"loadChildren\"\n]);\nvar splitProps = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.createSplitProps)(props);\nvar itemProps = (0,_zag_js_types__WEBPACK_IMPORTED_MODULE_5__.createProps)()([\"node\", \"indexPath\"]);\nvar splitItemProps = (0,_zag_js_utils__WEBPACK_IMPORTED_MODULE_2__.createSplitProps)(itemProps);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vQHphZy1qcyt0cmVlLXZpZXdAMS4xOC4yL25vZGVfbW9kdWxlcy9AemFnLWpzL3RyZWUtdmlldy9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZ0Q7QUFDb0I7QUFDa0g7QUFDcEM7QUFDdkY7QUFDZjs7QUFFNUM7QUFDQSxjQUFjLDhEQUFhO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDhEQUFjO0FBQzNCO0FBQ0E7QUFDQSxhQUFhLDhEQUFjLEdBQUcsWUFBWSxnQkFBZ0I7QUFDMUQ7QUFDQTtBQUNBLFNBQVMsa0VBQWM7QUFDdkI7O0FBRUE7QUFDQSxrREFBa0QsT0FBTztBQUN6RCxvREFBb0QsT0FBTztBQUMzRCxrRUFBa0UsT0FBTyxRQUFRLE1BQU07QUFDdkYsa0RBQWtELE9BQU87QUFDekQ7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHFCQUFxQjtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxtREFBSSxjQUFjLHFEQUFNLGlDQUFpQyxrREFBRztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsdUNBQXVDO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGtCQUFrQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLCtEQUFnQjtBQUNqQyxnQkFBZ0IsMERBQVc7QUFDM0IscUJBQXFCLCtEQUFnQjs7QUFFOEUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9wZXRlci9Eb2N1bWVudHMvR2l0SHViL2NyZWF0b3ItY2FyZC9ub2RlX21vZHVsZXMvLnBucG0vQHphZy1qcyt0cmVlLXZpZXdAMS4xOC4yL25vZGVfbW9kdWxlcy9AemFnLWpzL3RyZWUtdmlldy9kaXN0L2luZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVBbmF0b215IH0gZnJvbSAnQHphZy1qcy9hbmF0b215JztcbmltcG9ydCB7IFRyZWVDb2xsZWN0aW9uLCBmaWxlUGF0aFRvVHJlZSB9IGZyb20gJ0B6YWctanMvY29sbGVjdGlvbic7XG5pbXBvcnQgeyBnZXRCeVR5cGVhaGVhZCwgZGF0YUF0dHIsIGlzTGVmdENsaWNrLCBhcmlhQXR0ciwgaXNBbmNob3JFbGVtZW50LCBpc01vZGlmaWVyS2V5LCBpc0NvbXBvc2luZ0V2ZW50LCBnZXRFdmVudFRhcmdldCwgaXNFZGl0YWJsZUVsZW1lbnQsIGdldEV2ZW50S2V5IH0gZnJvbSAnQHphZy1qcy9kb20tcXVlcnknO1xuaW1wb3J0IHsgYWRkT3JSZW1vdmUsIGZpcnN0LCB1bmlxLCBkaWZmLCBpc0FycmF5LCB0b0FycmF5LCByZW1vdmUsIGxhc3QsIGlzRXF1YWwsIGNyZWF0ZVNwbGl0UHJvcHMsIGFkZCwgcGFydGl0aW9uLCBlbnN1cmUgfSBmcm9tICdAemFnLWpzL3V0aWxzJztcbmltcG9ydCB7IGNyZWF0ZUd1YXJkcywgY3JlYXRlTWFjaGluZSB9IGZyb20gJ0B6YWctanMvY29yZSc7XG5pbXBvcnQgeyBjcmVhdGVQcm9wcyB9IGZyb20gJ0B6YWctanMvdHlwZXMnO1xuXG4vLyBzcmMvdHJlZS12aWV3LmFuYXRvbXkudHNcbnZhciBhbmF0b215ID0gY3JlYXRlQW5hdG9teShcInRyZWUtdmlld1wiKS5wYXJ0cyhcbiAgXCJicmFuY2hcIixcbiAgXCJicmFuY2hDb250ZW50XCIsXG4gIFwiYnJhbmNoQ29udHJvbFwiLFxuICBcImJyYW5jaEluZGVudEd1aWRlXCIsXG4gIFwiYnJhbmNoSW5kaWNhdG9yXCIsXG4gIFwiYnJhbmNoVGV4dFwiLFxuICBcImJyYW5jaFRyaWdnZXJcIixcbiAgXCJpdGVtXCIsXG4gIFwiaXRlbUluZGljYXRvclwiLFxuICBcIml0ZW1UZXh0XCIsXG4gIFwibGFiZWxcIixcbiAgXCJub2RlQ2hlY2tib3hcIixcbiAgXCJyb290XCIsXG4gIFwidHJlZVwiXG4pO1xudmFyIHBhcnRzID0gYW5hdG9teS5idWlsZCgpO1xudmFyIGNvbGxlY3Rpb24gPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4gbmV3IFRyZWVDb2xsZWN0aW9uKG9wdGlvbnMpO1xufTtcbmNvbGxlY3Rpb24uZW1wdHkgPSAoKSA9PiB7XG4gIHJldHVybiBuZXcgVHJlZUNvbGxlY3Rpb24oeyByb290Tm9kZTogeyBjaGlsZHJlbjogW10gfSB9KTtcbn07XG5mdW5jdGlvbiBmaWxlUGF0aENvbGxlY3Rpb24ocGF0aHMpIHtcbiAgcmV0dXJuIGZpbGVQYXRoVG9UcmVlKHBhdGhzKTtcbn1cblxuLy8gc3JjL3RyZWUtdmlldy5kb20udHNcbnZhciBnZXRSb290SWQgPSAoY3R4KSA9PiBjdHguaWRzPy5yb290ID8/IGB0cmVlOiR7Y3R4LmlkfTpyb290YDtcbnZhciBnZXRMYWJlbElkID0gKGN0eCkgPT4gY3R4Lmlkcz8ubGFiZWwgPz8gYHRyZWU6JHtjdHguaWR9OmxhYmVsYDtcbnZhciBnZXROb2RlSWQgPSAoY3R4LCB2YWx1ZSkgPT4gY3R4Lmlkcz8ubm9kZT8uKHZhbHVlKSA/PyBgdHJlZToke2N0eC5pZH06bm9kZToke3ZhbHVlfWA7XG52YXIgZ2V0VHJlZUlkID0gKGN0eCkgPT4gY3R4Lmlkcz8udHJlZSA/PyBgdHJlZToke2N0eC5pZH06dHJlZWA7XG52YXIgZm9jdXNOb2RlID0gKGN0eCwgdmFsdWUpID0+IHtcbiAgaWYgKHZhbHVlID09IG51bGwpIHJldHVybjtcbiAgY29uc3Qgbm9kZUlkID0gZ2V0Tm9kZUlkKGN0eCwgdmFsdWUpO1xuICBjdHguZ2V0QnlJZChub2RlSWQpPy5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG59O1xuZnVuY3Rpb24gZ2V0Q2hlY2tlZFN0YXRlKGNvbGxlY3Rpb24yLCBub2RlLCBjaGVja2VkVmFsdWUpIHtcbiAgY29uc3QgdmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gIGlmICghY29sbGVjdGlvbjIuaXNCcmFuY2hOb2RlKG5vZGUpKSB7XG4gICAgcmV0dXJuIGNoZWNrZWRWYWx1ZS5pbmNsdWRlcyh2YWx1ZSk7XG4gIH1cbiAgY29uc3QgY2hpbGRWYWx1ZXMgPSBjb2xsZWN0aW9uMi5nZXREZXNjZW5kYW50VmFsdWVzKHZhbHVlKTtcbiAgY29uc3QgYWxsQ2hlY2tlZCA9IGNoaWxkVmFsdWVzLmV2ZXJ5KCh2KSA9PiBjaGVja2VkVmFsdWUuaW5jbHVkZXModikpO1xuICBjb25zdCBzb21lQ2hlY2tlZCA9IGNoaWxkVmFsdWVzLnNvbWUoKHYpID0+IGNoZWNrZWRWYWx1ZS5pbmNsdWRlcyh2KSk7XG4gIHJldHVybiBhbGxDaGVja2VkID8gdHJ1ZSA6IHNvbWVDaGVja2VkID8gXCJpbmRldGVybWluYXRlXCIgOiBmYWxzZTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZUJyYW5jaENoZWNrZWQoY29sbGVjdGlvbjIsIHZhbHVlLCBjaGVja2VkVmFsdWUpIHtcbiAgY29uc3QgY2hpbGRWYWx1ZXMgPSBjb2xsZWN0aW9uMi5nZXREZXNjZW5kYW50VmFsdWVzKHZhbHVlKTtcbiAgY29uc3QgYWxsQ2hlY2tlZCA9IGNoaWxkVmFsdWVzLmV2ZXJ5KChjaGlsZCkgPT4gY2hlY2tlZFZhbHVlLmluY2x1ZGVzKGNoaWxkKSk7XG4gIHJldHVybiB1bmlxKGFsbENoZWNrZWQgPyByZW1vdmUoY2hlY2tlZFZhbHVlLCAuLi5jaGlsZFZhbHVlcykgOiBhZGQoY2hlY2tlZFZhbHVlLCAuLi5jaGlsZFZhbHVlcykpO1xufVxuZnVuY3Rpb24gZ2V0Q2hlY2tlZFZhbHVlTWFwKGNvbGxlY3Rpb24yLCBjaGVja2VkVmFsdWUpIHtcbiAgY29uc3QgbWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgY29sbGVjdGlvbjIudmlzaXQoe1xuICAgIG9uRW50ZXI6IChub2RlKSA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShub2RlKTtcbiAgICAgIGNvbnN0IGlzQnJhbmNoID0gY29sbGVjdGlvbjIuaXNCcmFuY2hOb2RlKG5vZGUpO1xuICAgICAgY29uc3QgY2hlY2tlZCA9IGdldENoZWNrZWRTdGF0ZShjb2xsZWN0aW9uMiwgbm9kZSwgY2hlY2tlZFZhbHVlKTtcbiAgICAgIG1hcC5zZXQodmFsdWUsIHtcbiAgICAgICAgdHlwZTogaXNCcmFuY2ggPyBcImJyYW5jaFwiIDogXCJsZWFmXCIsXG4gICAgICAgIGNoZWNrZWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBtYXA7XG59XG5cbi8vIHNyYy90cmVlLXZpZXcuY29ubmVjdC50c1xuZnVuY3Rpb24gY29ubmVjdChzZXJ2aWNlLCBub3JtYWxpemUpIHtcbiAgY29uc3QgeyBjb250ZXh0LCBzY29wZSwgY29tcHV0ZWQsIHByb3AsIHNlbmQgfSA9IHNlcnZpY2U7XG4gIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gIGNvbnN0IGV4cGFuZGVkVmFsdWUgPSBBcnJheS5mcm9tKGNvbnRleHQuZ2V0KFwiZXhwYW5kZWRWYWx1ZVwiKSk7XG4gIGNvbnN0IHNlbGVjdGVkVmFsdWUgPSBBcnJheS5mcm9tKGNvbnRleHQuZ2V0KFwic2VsZWN0ZWRWYWx1ZVwiKSk7XG4gIGNvbnN0IGNoZWNrZWRWYWx1ZSA9IEFycmF5LmZyb20oY29udGV4dC5nZXQoXCJjaGVja2VkVmFsdWVcIikpO1xuICBjb25zdCBpc1R5cGluZ0FoZWFkID0gY29tcHV0ZWQoXCJpc1R5cGluZ0FoZWFkXCIpO1xuICBjb25zdCBmb2N1c2VkVmFsdWUgPSBjb250ZXh0LmdldChcImZvY3VzZWRWYWx1ZVwiKTtcbiAgY29uc3QgbG9hZGluZ1N0YXR1cyA9IGNvbnRleHQuZ2V0KFwibG9hZGluZ1N0YXR1c1wiKTtcbiAgZnVuY3Rpb24gZ2V0Tm9kZVN0YXRlKHByb3BzMikge1xuICAgIGNvbnN0IHsgbm9kZSwgaW5kZXhQYXRoIH0gPSBwcm9wczI7XG4gICAgY29uc3QgdmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gICAgY29uc3QgZmlyc3ROb2RlID0gY29sbGVjdGlvbjIuZ2V0Rmlyc3ROb2RlKCk7XG4gICAgY29uc3QgZmlyc3ROb2RlVmFsdWUgPSBmaXJzdE5vZGUgPyBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUoZmlyc3ROb2RlKSA6IG51bGw7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBnZXROb2RlSWQoc2NvcGUsIHZhbHVlKSxcbiAgICAgIHZhbHVlLFxuICAgICAgaW5kZXhQYXRoLFxuICAgICAgdmFsdWVQYXRoOiBjb2xsZWN0aW9uMi5nZXRWYWx1ZVBhdGgoaW5kZXhQYXRoKSxcbiAgICAgIGRpc2FibGVkOiBCb29sZWFuKG5vZGUuZGlzYWJsZWQpLFxuICAgICAgZm9jdXNlZDogZm9jdXNlZFZhbHVlID09IG51bGwgPyBmaXJzdE5vZGVWYWx1ZSA9PSB2YWx1ZSA6IGZvY3VzZWRWYWx1ZSA9PT0gdmFsdWUsXG4gICAgICBzZWxlY3RlZDogc2VsZWN0ZWRWYWx1ZS5pbmNsdWRlcyh2YWx1ZSksXG4gICAgICBleHBhbmRlZDogZXhwYW5kZWRWYWx1ZS5pbmNsdWRlcyh2YWx1ZSksXG4gICAgICBsb2FkaW5nOiBsb2FkaW5nU3RhdHVzW3ZhbHVlXSA9PT0gXCJsb2FkaW5nXCIsXG4gICAgICBkZXB0aDogaW5kZXhQYXRoLmxlbmd0aCxcbiAgICAgIGlzQnJhbmNoOiBjb2xsZWN0aW9uMi5pc0JyYW5jaE5vZGUobm9kZSksXG4gICAgICBnZXQgY2hlY2tlZCgpIHtcbiAgICAgICAgcmV0dXJuIGdldENoZWNrZWRTdGF0ZShjb2xsZWN0aW9uMiwgbm9kZSwgY2hlY2tlZFZhbHVlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgY29sbGVjdGlvbjogY29sbGVjdGlvbjIsXG4gICAgZXhwYW5kZWRWYWx1ZSxcbiAgICBzZWxlY3RlZFZhbHVlLFxuICAgIGNoZWNrZWRWYWx1ZSxcbiAgICB0b2dnbGVDaGVja2VkKHZhbHVlLCBpc0JyYW5jaCkge1xuICAgICAgc2VuZCh7IHR5cGU6IFwiQ0hFQ0tFRC5UT0dHTEVcIiwgdmFsdWUsIGlzQnJhbmNoIH0pO1xuICAgIH0sXG4gICAgc2V0Q2hlY2tlZCh2YWx1ZSkge1xuICAgICAgc2VuZCh7IHR5cGU6IFwiQ0hFQ0tFRC5TRVRcIiwgdmFsdWUgfSk7XG4gICAgfSxcbiAgICBjbGVhckNoZWNrZWQoKSB7XG4gICAgICBzZW5kKHsgdHlwZTogXCJDSEVDS0VELkNMRUFSXCIgfSk7XG4gICAgfSxcbiAgICBnZXRDaGVja2VkTWFwKCkge1xuICAgICAgcmV0dXJuIGdldENoZWNrZWRWYWx1ZU1hcChjb2xsZWN0aW9uMiwgY2hlY2tlZFZhbHVlKTtcbiAgICB9LFxuICAgIGV4cGFuZCh2YWx1ZSkge1xuICAgICAgc2VuZCh7IHR5cGU6IHZhbHVlID8gXCJCUkFOQ0guRVhQQU5EXCIgOiBcIkVYUEFOREVELkFMTFwiLCB2YWx1ZSB9KTtcbiAgICB9LFxuICAgIGNvbGxhcHNlKHZhbHVlKSB7XG4gICAgICBzZW5kKHsgdHlwZTogdmFsdWUgPyBcIkJSQU5DSC5DT0xMQVBTRVwiIDogXCJFWFBBTkRFRC5DTEVBUlwiLCB2YWx1ZSB9KTtcbiAgICB9LFxuICAgIGRlc2VsZWN0KHZhbHVlKSB7XG4gICAgICBzZW5kKHsgdHlwZTogdmFsdWUgPyBcIk5PREUuREVTRUxFQ1RcIiA6IFwiU0VMRUNURUQuQ0xFQVJcIiwgdmFsdWUgfSk7XG4gICAgfSxcbiAgICBzZWxlY3QodmFsdWUpIHtcbiAgICAgIHNlbmQoeyB0eXBlOiB2YWx1ZSA/IFwiTk9ERS5TRUxFQ1RcIiA6IFwiU0VMRUNURUQuQUxMXCIsIHZhbHVlLCBpc1RydXN0ZWQ6IGZhbHNlIH0pO1xuICAgIH0sXG4gICAgZ2V0VmlzaWJsZU5vZGVzKCkge1xuICAgICAgcmV0dXJuIGNvbXB1dGVkKFwidmlzaWJsZU5vZGVzXCIpLm1hcCgoeyBub2RlIH0pID0+IG5vZGUpO1xuICAgIH0sXG4gICAgZm9jdXModmFsdWUpIHtcbiAgICAgIGZvY3VzTm9kZShzY29wZSwgdmFsdWUpO1xuICAgIH0sXG4gICAgc2VsZWN0UGFyZW50KHZhbHVlKSB7XG4gICAgICBjb25zdCBwYXJlbnROb2RlID0gY29sbGVjdGlvbjIuZ2V0UGFyZW50Tm9kZSh2YWx1ZSk7XG4gICAgICBpZiAoIXBhcmVudE5vZGUpIHJldHVybjtcbiAgICAgIGNvbnN0IF9zZWxlY3RlZFZhbHVlID0gYWRkKHNlbGVjdGVkVmFsdWUsIGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShwYXJlbnROb2RlKSk7XG4gICAgICBzZW5kKHsgdHlwZTogXCJTRUxFQ1RFRC5TRVRcIiwgdmFsdWU6IF9zZWxlY3RlZFZhbHVlLCBzcmM6IFwic2VsZWN0LnBhcmVudFwiIH0pO1xuICAgIH0sXG4gICAgZXhwYW5kUGFyZW50KHZhbHVlKSB7XG4gICAgICBjb25zdCBwYXJlbnROb2RlID0gY29sbGVjdGlvbjIuZ2V0UGFyZW50Tm9kZSh2YWx1ZSk7XG4gICAgICBpZiAoIXBhcmVudE5vZGUpIHJldHVybjtcbiAgICAgIGNvbnN0IF9leHBhbmRlZFZhbHVlID0gYWRkKGV4cGFuZGVkVmFsdWUsIGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShwYXJlbnROb2RlKSk7XG4gICAgICBzZW5kKHsgdHlwZTogXCJFWFBBTkRFRC5TRVRcIiwgdmFsdWU6IF9leHBhbmRlZFZhbHVlLCBzcmM6IFwiZXhwYW5kLnBhcmVudFwiIH0pO1xuICAgIH0sXG4gICAgc2V0RXhwYW5kZWRWYWx1ZSh2YWx1ZSkge1xuICAgICAgY29uc3QgX2V4cGFuZGVkVmFsdWUgPSB1bmlxKHZhbHVlKTtcbiAgICAgIHNlbmQoeyB0eXBlOiBcIkVYUEFOREVELlNFVFwiLCB2YWx1ZTogX2V4cGFuZGVkVmFsdWUgfSk7XG4gICAgfSxcbiAgICBzZXRTZWxlY3RlZFZhbHVlKHZhbHVlKSB7XG4gICAgICBjb25zdCBfc2VsZWN0ZWRWYWx1ZSA9IHVuaXEodmFsdWUpO1xuICAgICAgc2VuZCh7IHR5cGU6IFwiU0VMRUNURUQuU0VUXCIsIHZhbHVlOiBfc2VsZWN0ZWRWYWx1ZSB9KTtcbiAgICB9LFxuICAgIGdldFJvb3RQcm9wcygpIHtcbiAgICAgIHJldHVybiBub3JtYWxpemUuZWxlbWVudCh7XG4gICAgICAgIC4uLnBhcnRzLnJvb3QuYXR0cnMsXG4gICAgICAgIGlkOiBnZXRSb290SWQoc2NvcGUpLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIilcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0TGFiZWxQcm9wcygpIHtcbiAgICAgIHJldHVybiBub3JtYWxpemUuZWxlbWVudCh7XG4gICAgICAgIC4uLnBhcnRzLmxhYmVsLmF0dHJzLFxuICAgICAgICBpZDogZ2V0TGFiZWxJZChzY29wZSksXG4gICAgICAgIGRpcjogcHJvcChcImRpclwiKVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXRUcmVlUHJvcHMoKSB7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy50cmVlLmF0dHJzLFxuICAgICAgICBpZDogZ2V0VHJlZUlkKHNjb3BlKSxcbiAgICAgICAgZGlyOiBwcm9wKFwiZGlyXCIpLFxuICAgICAgICByb2xlOiBcInRyZWVcIixcbiAgICAgICAgXCJhcmlhLWxhYmVsXCI6IFwiVHJlZSBWaWV3XCIsXG4gICAgICAgIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IGdldExhYmVsSWQoc2NvcGUpLFxuICAgICAgICBcImFyaWEtbXVsdGlzZWxlY3RhYmxlXCI6IHByb3AoXCJzZWxlY3Rpb25Nb2RlXCIpID09PSBcIm11bHRpcGxlXCIgfHwgdm9pZCAwLFxuICAgICAgICB0YWJJbmRleDogLTEsXG4gICAgICAgIG9uS2V5RG93bihldmVudCkge1xuICAgICAgICAgIGlmIChldmVudC5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG4gICAgICAgICAgaWYgKGlzQ29tcG9zaW5nRXZlbnQoZXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZXZlbnQpO1xuICAgICAgICAgIGlmIChpc0VkaXRhYmxlRWxlbWVudCh0YXJnZXQpKSByZXR1cm47XG4gICAgICAgICAgY29uc3Qgbm9kZSA9IHRhcmdldD8uY2xvc2VzdChcIltkYXRhLXBhcnQ9YnJhbmNoLWNvbnRyb2xdLCBbZGF0YS1wYXJ0PWl0ZW1dXCIpO1xuICAgICAgICAgIGlmICghbm9kZSkgcmV0dXJuO1xuICAgICAgICAgIGNvbnN0IG5vZGVJZCA9IG5vZGUuZGF0YXNldC52YWx1ZTtcbiAgICAgICAgICBpZiAobm9kZUlkID09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgW3phZy1qcy90cmVlLXZpZXddIE5vZGUgaWQgbm90IGZvdW5kIGZvciBub2RlYCwgbm9kZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGlzQnJhbmNoTm9kZSA9IG5vZGUubWF0Y2hlcyhcIltkYXRhLXBhcnQ9YnJhbmNoLWNvbnRyb2xdXCIpO1xuICAgICAgICAgIGNvbnN0IGtleU1hcCA9IHtcbiAgICAgICAgICAgIEFycm93RG93bihldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKGlzTW9kaWZpZXJLZXkoZXZlbnQyKSkgcmV0dXJuO1xuICAgICAgICAgICAgICBldmVudDIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IFwiTk9ERS5BUlJPV19ET1dOXCIsIGlkOiBub2RlSWQsIHNoaWZ0S2V5OiBldmVudDIuc2hpZnRLZXkgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgQXJyb3dVcChldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKGlzTW9kaWZpZXJLZXkoZXZlbnQyKSkgcmV0dXJuO1xuICAgICAgICAgICAgICBldmVudDIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IFwiTk9ERS5BUlJPV19VUFwiLCBpZDogbm9kZUlkLCBzaGlmdEtleTogZXZlbnQyLnNoaWZ0S2V5IH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEFycm93TGVmdChldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKGlzTW9kaWZpZXJLZXkoZXZlbnQyKSB8fCBub2RlLmRhdGFzZXQuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBpc0JyYW5jaE5vZGUgPyBcIkJSQU5DSF9OT0RFLkFSUk9XX0xFRlRcIiA6IFwiTk9ERS5BUlJPV19MRUZUXCIsIGlkOiBub2RlSWQgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgQXJyb3dSaWdodChldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKCFpc0JyYW5jaE5vZGUgfHwgbm9kZS5kYXRhc2V0LmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgICAgIGV2ZW50Mi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogXCJCUkFOQ0hfTk9ERS5BUlJPV19SSUdIVFwiLCBpZDogbm9kZUlkIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEhvbWUoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChpc01vZGlmaWVyS2V5KGV2ZW50MikpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuSE9NRVwiLCBpZDogbm9kZUlkLCBzaGlmdEtleTogZXZlbnQyLnNoaWZ0S2V5IH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIEVuZChldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKGlzTW9kaWZpZXJLZXkoZXZlbnQyKSkgcmV0dXJuO1xuICAgICAgICAgICAgICBldmVudDIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IFwiTk9ERS5FTkRcIiwgaWQ6IG5vZGVJZCwgc2hpZnRLZXk6IGV2ZW50Mi5zaGlmdEtleSB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBTcGFjZShldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YXNldC5kaXNhYmxlZCkgcmV0dXJuO1xuICAgICAgICAgICAgICBpZiAoaXNUeXBpbmdBaGVhZCkge1xuICAgICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIlRSRUUuVFlQRUFIRUFEXCIsIGtleTogZXZlbnQyLmtleSB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBrZXlNYXAuRW50ZXI/LihldmVudDIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgRW50ZXIoZXZlbnQyKSB7XG4gICAgICAgICAgICAgIGlmIChub2RlLmRhdGFzZXQuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgaWYgKGlzQW5jaG9yRWxlbWVudCh0YXJnZXQpICYmIGlzTW9kaWZpZXJLZXkoZXZlbnQyKSkgcmV0dXJuO1xuICAgICAgICAgICAgICBzZW5kKHsgdHlwZTogaXNCcmFuY2hOb2RlID8gXCJCUkFOQ0hfTk9ERS5DTElDS1wiIDogXCJOT0RFLkNMSUNLXCIsIGlkOiBub2RlSWQsIHNyYzogXCJrZXlib2FyZFwiIH0pO1xuICAgICAgICAgICAgICBpZiAoIWlzQW5jaG9yRWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcIipcIihldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YXNldC5kaXNhYmxlZCkgcmV0dXJuO1xuICAgICAgICAgICAgICBldmVudDIucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgc2VuZCh7IHR5cGU6IFwiU0lCTElOR1MuRVhQQU5EXCIsIGlkOiBub2RlSWQgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYShldmVudDIpIHtcbiAgICAgICAgICAgICAgaWYgKCFldmVudDIubWV0YUtleSB8fCBub2RlLmRhdGFzZXQuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgZXZlbnQyLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIlNFTEVDVEVELkFMTFwiLCBtb3ZlRm9jdXM6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCBrZXkgPSBnZXRFdmVudEtleShldmVudCwgeyBkaXI6IHByb3AoXCJkaXJcIikgfSk7XG4gICAgICAgICAgY29uc3QgZXhlYyA9IGtleU1hcFtrZXldO1xuICAgICAgICAgIGlmIChleGVjKSB7XG4gICAgICAgICAgICBleGVjKGV2ZW50KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFnZXRCeVR5cGVhaGVhZC5pc1ZhbGlkRXZlbnQoZXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgc2VuZCh7IHR5cGU6IFwiVFJFRS5UWVBFQUhFQURcIiwga2V5OiBldmVudC5rZXksIGlkOiBub2RlSWQgfSk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBnZXROb2RlU3RhdGUsXG4gICAgZ2V0SXRlbVByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5pdGVtLmF0dHJzLFxuICAgICAgICBpZDogbm9kZVN0YXRlLmlkLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIFwiZGF0YS1vd25lZGJ5XCI6IGdldFRyZWVJZChzY29wZSksXG4gICAgICAgIFwiZGF0YS1wYXRoXCI6IHByb3BzMi5pbmRleFBhdGguam9pbihcIi9cIiksXG4gICAgICAgIFwiZGF0YS12YWx1ZVwiOiBub2RlU3RhdGUudmFsdWUsXG4gICAgICAgIHRhYkluZGV4OiBub2RlU3RhdGUuZm9jdXNlZCA/IDAgOiAtMSxcbiAgICAgICAgXCJkYXRhLWZvY3VzXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5mb2N1c2VkKSxcbiAgICAgICAgcm9sZTogXCJ0cmVlaXRlbVwiLFxuICAgICAgICBcImFyaWEtY3VycmVudFwiOiBub2RlU3RhdGUuc2VsZWN0ZWQgPyBcInRydWVcIiA6IHZvaWQgMCxcbiAgICAgICAgXCJhcmlhLXNlbGVjdGVkXCI6IG5vZGVTdGF0ZS5kaXNhYmxlZCA/IHZvaWQgMCA6IG5vZGVTdGF0ZS5zZWxlY3RlZCxcbiAgICAgICAgXCJkYXRhLXNlbGVjdGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5zZWxlY3RlZCksXG4gICAgICAgIFwiYXJpYS1kaXNhYmxlZFwiOiBhcmlhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJhcmlhLWxldmVsXCI6IG5vZGVTdGF0ZS5kZXB0aCxcbiAgICAgICAgXCJkYXRhLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aCxcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBcIi0tZGVwdGhcIjogbm9kZVN0YXRlLmRlcHRoXG4gICAgICAgIH0sXG4gICAgICAgIG9uRm9jdXMoZXZlbnQpIHtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICBzZW5kKHsgdHlwZTogXCJOT0RFLkZPQ1VTXCIsIGlkOiBub2RlU3RhdGUudmFsdWUgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgICBpZiAobm9kZVN0YXRlLmRpc2FibGVkKSByZXR1cm47XG4gICAgICAgICAgaWYgKCFpc0xlZnRDbGljayhldmVudCkpIHJldHVybjtcbiAgICAgICAgICBpZiAoaXNBbmNob3JFbGVtZW50KGV2ZW50LmN1cnJlbnRUYXJnZXQpICYmIGlzTW9kaWZpZXJLZXkoZXZlbnQpKSByZXR1cm47XG4gICAgICAgICAgY29uc3QgaXNNZXRhS2V5ID0gZXZlbnQubWV0YUtleSB8fCBldmVudC5jdHJsS2V5O1xuICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuQ0xJQ0tcIiwgaWQ6IG5vZGVTdGF0ZS52YWx1ZSwgc2hpZnRLZXk6IGV2ZW50LnNoaWZ0S2V5LCBjdHJsS2V5OiBpc01ldGFLZXkgfSk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgaWYgKCFpc0FuY2hvckVsZW1lbnQoZXZlbnQuY3VycmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEl0ZW1UZXh0UHJvcHMocHJvcHMyKSB7XG4gICAgICBjb25zdCBpdGVtU3RhdGUgPSBnZXROb2RlU3RhdGUocHJvcHMyKTtcbiAgICAgIHJldHVybiBub3JtYWxpemUuZWxlbWVudCh7XG4gICAgICAgIC4uLnBhcnRzLml0ZW1UZXh0LmF0dHJzLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIoaXRlbVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLXNlbGVjdGVkXCI6IGRhdGFBdHRyKGl0ZW1TdGF0ZS5zZWxlY3RlZCksXG4gICAgICAgIFwiZGF0YS1mb2N1c1wiOiBkYXRhQXR0cihpdGVtU3RhdGUuZm9jdXNlZClcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0SXRlbUluZGljYXRvclByb3BzKHByb3BzMikge1xuICAgICAgY29uc3QgaXRlbVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5pdGVtSW5kaWNhdG9yLmF0dHJzLFxuICAgICAgICBcImFyaWEtaGlkZGVuXCI6IHRydWUsXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihpdGVtU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtc2VsZWN0ZWRcIjogZGF0YUF0dHIoaXRlbVN0YXRlLnNlbGVjdGVkKSxcbiAgICAgICAgXCJkYXRhLWZvY3VzXCI6IGRhdGFBdHRyKGl0ZW1TdGF0ZS5mb2N1c2VkKSxcbiAgICAgICAgaGlkZGVuOiAhaXRlbVN0YXRlLnNlbGVjdGVkXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2guYXR0cnMsXG4gICAgICAgIFwiZGF0YS1kZXB0aFwiOiBub2RlU3RhdGUuZGVwdGgsXG4gICAgICAgIGRpcjogcHJvcChcImRpclwiKSxcbiAgICAgICAgXCJkYXRhLWJyYW5jaFwiOiBub2RlU3RhdGUudmFsdWUsXG4gICAgICAgIHJvbGU6IFwidHJlZWl0ZW1cIixcbiAgICAgICAgXCJkYXRhLW93bmVkYnlcIjogZ2V0VHJlZUlkKHNjb3BlKSxcbiAgICAgICAgXCJkYXRhLXZhbHVlXCI6IG5vZGVTdGF0ZS52YWx1ZSxcbiAgICAgICAgXCJhcmlhLWxldmVsXCI6IG5vZGVTdGF0ZS5kZXB0aCxcbiAgICAgICAgXCJhcmlhLXNlbGVjdGVkXCI6IG5vZGVTdGF0ZS5kaXNhYmxlZCA/IHZvaWQgMCA6IG5vZGVTdGF0ZS5zZWxlY3RlZCxcbiAgICAgICAgXCJkYXRhLXBhdGhcIjogcHJvcHMyLmluZGV4UGF0aC5qb2luKFwiL1wiKSxcbiAgICAgICAgXCJkYXRhLXNlbGVjdGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5zZWxlY3RlZCksXG4gICAgICAgIFwiYXJpYS1leHBhbmRlZFwiOiBub2RlU3RhdGUuZXhwYW5kZWQsXG4gICAgICAgIFwiZGF0YS1zdGF0ZVwiOiBub2RlU3RhdGUuZXhwYW5kZWQgPyBcIm9wZW5cIiA6IFwiY2xvc2VkXCIsXG4gICAgICAgIFwiYXJpYS1kaXNhYmxlZFwiOiBhcmlhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtZGlzYWJsZWRcIjogZGF0YUF0dHIobm9kZVN0YXRlLmRpc2FibGVkKSxcbiAgICAgICAgXCJkYXRhLWxvYWRpbmdcIjogZGF0YUF0dHIobm9kZVN0YXRlLmxvYWRpbmcpLFxuICAgICAgICBcImFyaWEtYnVzeVwiOiBhcmlhQXR0cihub2RlU3RhdGUubG9hZGluZyksXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgXCItLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaEluZGljYXRvclByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hJbmRpY2F0b3IuYXR0cnMsXG4gICAgICAgIFwiYXJpYS1oaWRkZW5cIjogdHJ1ZSxcbiAgICAgICAgXCJkYXRhLXN0YXRlXCI6IG5vZGVTdGF0ZS5leHBhbmRlZCA/IFwib3BlblwiIDogXCJjbG9zZWRcIixcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIFwiZGF0YS1zZWxlY3RlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuc2VsZWN0ZWQpLFxuICAgICAgICBcImRhdGEtZm9jdXNcIjogZGF0YUF0dHIobm9kZVN0YXRlLmZvY3VzZWQpLFxuICAgICAgICBcImRhdGEtbG9hZGluZ1wiOiBkYXRhQXR0cihub2RlU3RhdGUubG9hZGluZylcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0QnJhbmNoVHJpZ2dlclByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hUcmlnZ2VyLmF0dHJzLFxuICAgICAgICByb2xlOiBcImJ1dHRvblwiLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtc3RhdGVcIjogbm9kZVN0YXRlLmV4cGFuZGVkID8gXCJvcGVuXCIgOiBcImNsb3NlZFwiLFxuICAgICAgICBcImRhdGEtdmFsdWVcIjogbm9kZVN0YXRlLnZhbHVlLFxuICAgICAgICBcImRhdGEtbG9hZGluZ1wiOiBkYXRhQXR0cihub2RlU3RhdGUubG9hZGluZyksXG4gICAgICAgIGRpc2FibGVkOiBub2RlU3RhdGUubG9hZGluZyxcbiAgICAgICAgb25DbGljayhldmVudCkge1xuICAgICAgICAgIGlmIChub2RlU3RhdGUuZGlzYWJsZWQgfHwgbm9kZVN0YXRlLmxvYWRpbmcpIHJldHVybjtcbiAgICAgICAgICBzZW5kKHsgdHlwZTogXCJCUkFOQ0hfVE9HR0xFLkNMSUNLXCIsIGlkOiBub2RlU3RhdGUudmFsdWUgfSk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0QnJhbmNoQ29udHJvbFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hDb250cm9sLmF0dHJzLFxuICAgICAgICByb2xlOiBcImJ1dHRvblwiLFxuICAgICAgICBpZDogbm9kZVN0YXRlLmlkLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIHRhYkluZGV4OiBub2RlU3RhdGUuZm9jdXNlZCA/IDAgOiAtMSxcbiAgICAgICAgXCJkYXRhLXBhdGhcIjogcHJvcHMyLmluZGV4UGF0aC5qb2luKFwiL1wiKSxcbiAgICAgICAgXCJkYXRhLXN0YXRlXCI6IG5vZGVTdGF0ZS5leHBhbmRlZCA/IFwib3BlblwiIDogXCJjbG9zZWRcIixcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIFwiZGF0YS1zZWxlY3RlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuc2VsZWN0ZWQpLFxuICAgICAgICBcImRhdGEtZm9jdXNcIjogZGF0YUF0dHIobm9kZVN0YXRlLmZvY3VzZWQpLFxuICAgICAgICBcImRhdGEtdmFsdWVcIjogbm9kZVN0YXRlLnZhbHVlLFxuICAgICAgICBcImRhdGEtZGVwdGhcIjogbm9kZVN0YXRlLmRlcHRoLFxuICAgICAgICBcImRhdGEtbG9hZGluZ1wiOiBkYXRhQXR0cihub2RlU3RhdGUubG9hZGluZyksXG4gICAgICAgIFwiYXJpYS1idXN5XCI6IGFyaWFBdHRyKG5vZGVTdGF0ZS5sb2FkaW5nKSxcbiAgICAgICAgb25Gb2N1cyhldmVudCkge1xuICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIk5PREUuRk9DVVNcIiwgaWQ6IG5vZGVTdGF0ZS52YWx1ZSB9KTtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfSxcbiAgICAgICAgb25DbGljayhldmVudCkge1xuICAgICAgICAgIGlmIChub2RlU3RhdGUuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICBpZiAobm9kZVN0YXRlLmxvYWRpbmcpIHJldHVybjtcbiAgICAgICAgICBpZiAoIWlzTGVmdENsaWNrKGV2ZW50KSkgcmV0dXJuO1xuICAgICAgICAgIGlmIChpc0FuY2hvckVsZW1lbnQoZXZlbnQuY3VycmVudFRhcmdldCkgJiYgaXNNb2RpZmllcktleShldmVudCkpIHJldHVybjtcbiAgICAgICAgICBjb25zdCBpc01ldGFLZXkgPSBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmN0cmxLZXk7XG4gICAgICAgICAgc2VuZCh7IHR5cGU6IFwiQlJBTkNIX05PREUuQ0xJQ0tcIiwgaWQ6IG5vZGVTdGF0ZS52YWx1ZSwgc2hpZnRLZXk6IGV2ZW50LnNoaWZ0S2V5LCBjdHJsS2V5OiBpc01ldGFLZXkgfSk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0QnJhbmNoVGV4dFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hUZXh0LmF0dHJzLFxuICAgICAgICBkaXI6IHByb3AoXCJkaXJcIiksXG4gICAgICAgIFwiZGF0YS1kaXNhYmxlZFwiOiBkYXRhQXR0cihub2RlU3RhdGUuZGlzYWJsZWQpLFxuICAgICAgICBcImRhdGEtc3RhdGVcIjogbm9kZVN0YXRlLmV4cGFuZGVkID8gXCJvcGVuXCIgOiBcImNsb3NlZFwiLFxuICAgICAgICBcImRhdGEtbG9hZGluZ1wiOiBkYXRhQXR0cihub2RlU3RhdGUubG9hZGluZylcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ2V0QnJhbmNoQ29udGVudFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICByZXR1cm4gbm9ybWFsaXplLmVsZW1lbnQoe1xuICAgICAgICAuLi5wYXJ0cy5icmFuY2hDb250ZW50LmF0dHJzLFxuICAgICAgICByb2xlOiBcImdyb3VwXCIsXG4gICAgICAgIGRpcjogcHJvcChcImRpclwiKSxcbiAgICAgICAgXCJkYXRhLXN0YXRlXCI6IG5vZGVTdGF0ZS5leHBhbmRlZCA/IFwib3BlblwiIDogXCJjbG9zZWRcIixcbiAgICAgICAgXCJkYXRhLWRlcHRoXCI6IG5vZGVTdGF0ZS5kZXB0aCxcbiAgICAgICAgXCJkYXRhLXBhdGhcIjogcHJvcHMyLmluZGV4UGF0aC5qb2luKFwiL1wiKSxcbiAgICAgICAgXCJkYXRhLXZhbHVlXCI6IG5vZGVTdGF0ZS52YWx1ZSxcbiAgICAgICAgaGlkZGVuOiAhbm9kZVN0YXRlLmV4cGFuZGVkXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldEJyYW5jaEluZGVudEd1aWRlUHJvcHMocHJvcHMyKSB7XG4gICAgICBjb25zdCBub2RlU3RhdGUgPSBnZXROb2RlU3RhdGUocHJvcHMyKTtcbiAgICAgIHJldHVybiBub3JtYWxpemUuZWxlbWVudCh7XG4gICAgICAgIC4uLnBhcnRzLmJyYW5jaEluZGVudEd1aWRlLmF0dHJzLFxuICAgICAgICBcImRhdGEtZGVwdGhcIjogbm9kZVN0YXRlLmRlcHRoXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdldE5vZGVDaGVja2JveFByb3BzKHByb3BzMikge1xuICAgICAgY29uc3Qgbm9kZVN0YXRlID0gZ2V0Tm9kZVN0YXRlKHByb3BzMik7XG4gICAgICBjb25zdCBjaGVja2VkU3RhdGUgPSBub2RlU3RhdGUuY2hlY2tlZDtcbiAgICAgIHJldHVybiBub3JtYWxpemUuZWxlbWVudCh7XG4gICAgICAgIC4uLnBhcnRzLm5vZGVDaGVja2JveC5hdHRycyxcbiAgICAgICAgdGFiSW5kZXg6IC0xLFxuICAgICAgICByb2xlOiBcImNoZWNrYm94XCIsXG4gICAgICAgIFwiZGF0YS1zdGF0ZVwiOiBjaGVja2VkU3RhdGUgPT09IHRydWUgPyBcImNoZWNrZWRcIiA6IGNoZWNrZWRTdGF0ZSA9PT0gZmFsc2UgPyBcInVuY2hlY2tlZFwiIDogXCJpbmRldGVybWluYXRlXCIsXG4gICAgICAgIFwiYXJpYS1jaGVja2VkXCI6IGNoZWNrZWRTdGF0ZSA9PT0gdHJ1ZSA/IFwidHJ1ZVwiIDogY2hlY2tlZFN0YXRlID09PSBmYWxzZSA/IFwiZmFsc2VcIiA6IFwibWl4ZWRcIixcbiAgICAgICAgXCJkYXRhLWRpc2FibGVkXCI6IGRhdGFBdHRyKG5vZGVTdGF0ZS5kaXNhYmxlZCksXG4gICAgICAgIG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgICBpZiAoZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgcmV0dXJuO1xuICAgICAgICAgIGlmIChub2RlU3RhdGUuZGlzYWJsZWQpIHJldHVybjtcbiAgICAgICAgICBpZiAoIWlzTGVmdENsaWNrKGV2ZW50KSkgcmV0dXJuO1xuICAgICAgICAgIHNlbmQoeyB0eXBlOiBcIkNIRUNLRUQuVE9HR0xFXCIsIHZhbHVlOiBub2RlU3RhdGUudmFsdWUsIGlzQnJhbmNoOiBub2RlU3RhdGUuaXNCcmFuY2ggfSk7XG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgY29uc3Qgbm9kZSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuY2xvc2VzdChcIltyb2xlPXRyZWVpdGVtXVwiKTtcbiAgICAgICAgICBub2RlPy5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1cbmZ1bmN0aW9uIGV4cGFuZEJyYW5jaGVzKHBhcmFtcywgdmFsdWVzKSB7XG4gIGNvbnN0IHsgY29udGV4dCwgcHJvcCwgcmVmcyB9ID0gcGFyYW1zO1xuICBpZiAoIXByb3AoXCJsb2FkQ2hpbGRyZW5cIikpIHtcbiAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgKHByZXYpID0+IHVuaXEoYWRkKHByZXYsIC4uLnZhbHVlcykpKTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgbG9hZGluZ1N0YXR1cyA9IGNvbnRleHQuZ2V0KFwibG9hZGluZ1N0YXR1c1wiKTtcbiAgY29uc3QgW2xvYWRlZFZhbHVlcywgbG9hZGluZ1ZhbHVlc10gPSBwYXJ0aXRpb24odmFsdWVzLCAodmFsdWUpID0+IGxvYWRpbmdTdGF0dXNbdmFsdWVdID09PSBcImxvYWRlZFwiKTtcbiAgaWYgKGxvYWRlZFZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIChwcmV2KSA9PiB1bmlxKGFkZChwcmV2LCAuLi5sb2FkZWRWYWx1ZXMpKSk7XG4gIH1cbiAgaWYgKGxvYWRpbmdWYWx1ZXMubGVuZ3RoID09PSAwKSByZXR1cm47XG4gIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gIGNvbnN0IFtub2RlV2l0aENoaWxkcmVuLCBub2RlV2l0aG91dENoaWxkcmVuXSA9IHBhcnRpdGlvbihsb2FkaW5nVmFsdWVzLCAoaWQpID0+IHtcbiAgICBjb25zdCBub2RlID0gY29sbGVjdGlvbjIuZmluZE5vZGUoaWQpO1xuICAgIHJldHVybiBjb2xsZWN0aW9uMi5nZXROb2RlQ2hpbGRyZW4obm9kZSkubGVuZ3RoID4gMDtcbiAgfSk7XG4gIGlmIChub2RlV2l0aENoaWxkcmVuLmxlbmd0aCA+IDApIHtcbiAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgKHByZXYpID0+IHVuaXEoYWRkKHByZXYsIC4uLm5vZGVXaXRoQ2hpbGRyZW4pKSk7XG4gIH1cbiAgaWYgKG5vZGVXaXRob3V0Q2hpbGRyZW4ubGVuZ3RoID09PSAwKSByZXR1cm47XG4gIGNvbnRleHQuc2V0KFwibG9hZGluZ1N0YXR1c1wiLCAocHJldikgPT4gKHtcbiAgICAuLi5wcmV2LFxuICAgIC4uLm5vZGVXaXRob3V0Q2hpbGRyZW4ucmVkdWNlKChhY2MsIGlkKSA9PiAoeyAuLi5hY2MsIFtpZF06IFwibG9hZGluZ1wiIH0pLCB7fSlcbiAgfSkpO1xuICBjb25zdCBub2Rlc1RvTG9hZCA9IG5vZGVXaXRob3V0Q2hpbGRyZW4ubWFwKChpZCkgPT4ge1xuICAgIGNvbnN0IGluZGV4UGF0aCA9IGNvbGxlY3Rpb24yLmdldEluZGV4UGF0aChpZCk7XG4gICAgY29uc3QgdmFsdWVQYXRoID0gY29sbGVjdGlvbjIuZ2V0VmFsdWVQYXRoKGluZGV4UGF0aCk7XG4gICAgY29uc3Qgbm9kZSA9IGNvbGxlY3Rpb24yLmZpbmROb2RlKGlkKTtcbiAgICByZXR1cm4geyBpZCwgaW5kZXhQYXRoLCB2YWx1ZVBhdGgsIG5vZGUgfTtcbiAgfSk7XG4gIGNvbnN0IHBlbmRpbmdBYm9ydHMgPSByZWZzLmdldChcInBlbmRpbmdBYm9ydHNcIik7XG4gIGNvbnN0IGxvYWRDaGlsZHJlbiA9IHByb3AoXCJsb2FkQ2hpbGRyZW5cIik7XG4gIGVuc3VyZShsb2FkQ2hpbGRyZW4sICgpID0+IFwiW3phZy1qcy90cmVlLXZpZXddIGBsb2FkQ2hpbGRyZW5gIGlzIHJlcXVpcmVkIGZvciBhc3luYyBleHBhbnNpb25cIik7XG4gIGNvbnN0IHByb21zID0gbm9kZXNUb0xvYWQubWFwKCh7IGlkLCBpbmRleFBhdGgsIHZhbHVlUGF0aCwgbm9kZSB9KSA9PiB7XG4gICAgY29uc3QgZXhpc3RpbmdBYm9ydCA9IHBlbmRpbmdBYm9ydHMuZ2V0KGlkKTtcbiAgICBpZiAoZXhpc3RpbmdBYm9ydCkge1xuICAgICAgZXhpc3RpbmdBYm9ydC5hYm9ydCgpO1xuICAgICAgcGVuZGluZ0Fib3J0cy5kZWxldGUoaWQpO1xuICAgIH1cbiAgICBjb25zdCBhYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgcGVuZGluZ0Fib3J0cy5zZXQoaWQsIGFib3J0Q29udHJvbGxlcik7XG4gICAgcmV0dXJuIGxvYWRDaGlsZHJlbih7XG4gICAgICB2YWx1ZVBhdGgsXG4gICAgICBpbmRleFBhdGgsXG4gICAgICBub2RlLFxuICAgICAgc2lnbmFsOiBhYm9ydENvbnRyb2xsZXIuc2lnbmFsXG4gICAgfSk7XG4gIH0pO1xuICBQcm9taXNlLmFsbFNldHRsZWQocHJvbXMpLnRoZW4oKHJlc3VsdHMpID0+IHtcbiAgICBjb25zdCBsb2FkZWRWYWx1ZXMyID0gW107XG4gICAgY29uc3Qgbm9kZVdpdGhFcnJvcnMgPSBbXTtcbiAgICBjb25zdCBuZXh0TG9hZGluZ1N0YXR1cyA9IGNvbnRleHQuZ2V0KFwibG9hZGluZ1N0YXR1c1wiKTtcbiAgICBsZXQgY29sbGVjdGlvbjMgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICByZXN1bHRzLmZvckVhY2goKHJlc3VsdCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHsgaWQsIGluZGV4UGF0aCwgbm9kZSwgdmFsdWVQYXRoIH0gPSBub2Rlc1RvTG9hZFtpbmRleF07XG4gICAgICBpZiAocmVzdWx0LnN0YXR1cyA9PT0gXCJmdWxmaWxsZWRcIikge1xuICAgICAgICBuZXh0TG9hZGluZ1N0YXR1c1tpZF0gPSBcImxvYWRlZFwiO1xuICAgICAgICBsb2FkZWRWYWx1ZXMyLnB1c2goaWQpO1xuICAgICAgICBjb2xsZWN0aW9uMyA9IGNvbGxlY3Rpb24zLnJlcGxhY2UoaW5kZXhQYXRoLCB7IC4uLm5vZGUsIGNoaWxkcmVuOiByZXN1bHQudmFsdWUgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwZW5kaW5nQWJvcnRzLmRlbGV0ZShpZCk7XG4gICAgICAgIFJlZmxlY3QuZGVsZXRlUHJvcGVydHkobmV4dExvYWRpbmdTdGF0dXMsIGlkKTtcbiAgICAgICAgbm9kZVdpdGhFcnJvcnMucHVzaCh7IG5vZGUsIGVycm9yOiByZXN1bHQucmVhc29uLCBpbmRleFBhdGgsIHZhbHVlUGF0aCB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb250ZXh0LnNldChcImxvYWRpbmdTdGF0dXNcIiwgbmV4dExvYWRpbmdTdGF0dXMpO1xuICAgIGlmIChsb2FkZWRWYWx1ZXMyLmxlbmd0aCkge1xuICAgICAgY29udGV4dC5zZXQoXCJleHBhbmRlZFZhbHVlXCIsIChwcmV2KSA9PiB1bmlxKGFkZChwcmV2LCAuLi5sb2FkZWRWYWx1ZXMyKSkpO1xuICAgICAgcHJvcChcIm9uTG9hZENoaWxkcmVuQ29tcGxldGVcIik/Lih7IGNvbGxlY3Rpb246IGNvbGxlY3Rpb24zIH0pO1xuICAgIH1cbiAgICBpZiAobm9kZVdpdGhFcnJvcnMubGVuZ3RoKSB7XG4gICAgICBwcm9wKFwib25Mb2FkQ2hpbGRyZW5FcnJvclwiKT8uKHsgbm9kZXM6IG5vZGVXaXRoRXJyb3JzIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8vIHNyYy91dGlscy92aXNpdC1za2lwLnRzXG5mdW5jdGlvbiBza2lwRm4ocGFyYW1zKSB7XG4gIGNvbnN0IHsgcHJvcCwgY29udGV4dCB9ID0gcGFyYW1zO1xuICByZXR1cm4gZnVuY3Rpb24gc2tpcCh7IGluZGV4UGF0aCB9KSB7XG4gICAgY29uc3QgcGF0aHMgPSBwcm9wKFwiY29sbGVjdGlvblwiKS5nZXRWYWx1ZVBhdGgoaW5kZXhQYXRoKS5zbGljZSgwLCAtMSk7XG4gICAgcmV0dXJuIHBhdGhzLnNvbWUoKHZhbHVlKSA9PiAhY29udGV4dC5nZXQoXCJleHBhbmRlZFZhbHVlXCIpLmluY2x1ZGVzKHZhbHVlKSk7XG4gIH07XG59XG5cbi8vIHNyYy90cmVlLXZpZXcubWFjaGluZS50c1xudmFyIHsgYW5kIH0gPSBjcmVhdGVHdWFyZHMoKTtcbnZhciBtYWNoaW5lID0gY3JlYXRlTWFjaGluZSh7XG4gIHByb3BzKHsgcHJvcHM6IHByb3BzMiB9KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNlbGVjdGlvbk1vZGU6IFwic2luZ2xlXCIsXG4gICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uLmVtcHR5KCksXG4gICAgICB0eXBlYWhlYWQ6IHRydWUsXG4gICAgICBleHBhbmRPbkNsaWNrOiB0cnVlLFxuICAgICAgZGVmYXVsdEV4cGFuZGVkVmFsdWU6IFtdLFxuICAgICAgZGVmYXVsdFNlbGVjdGVkVmFsdWU6IFtdLFxuICAgICAgLi4ucHJvcHMyXG4gICAgfTtcbiAgfSxcbiAgaW5pdGlhbFN0YXRlKCkge1xuICAgIHJldHVybiBcImlkbGVcIjtcbiAgfSxcbiAgY29udGV4dCh7IHByb3AsIGJpbmRhYmxlLCBnZXRDb250ZXh0IH0pIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXhwYW5kZWRWYWx1ZTogYmluZGFibGUoKCkgPT4gKHtcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBwcm9wKFwiZGVmYXVsdEV4cGFuZGVkVmFsdWVcIiksXG4gICAgICAgIHZhbHVlOiBwcm9wKFwiZXhwYW5kZWRWYWx1ZVwiKSxcbiAgICAgICAgaXNFcXVhbCxcbiAgICAgICAgb25DaGFuZ2UoZXhwYW5kZWRWYWx1ZSkge1xuICAgICAgICAgIGNvbnN0IGN0eCA9IGdldENvbnRleHQoKTtcbiAgICAgICAgICBjb25zdCBmb2N1c2VkVmFsdWUgPSBjdHguZ2V0KFwiZm9jdXNlZFZhbHVlXCIpO1xuICAgICAgICAgIHByb3AoXCJvbkV4cGFuZGVkQ2hhbmdlXCIpPy4oe1xuICAgICAgICAgICAgZXhwYW5kZWRWYWx1ZSxcbiAgICAgICAgICAgIGZvY3VzZWRWYWx1ZSxcbiAgICAgICAgICAgIGdldCBleHBhbmRlZE5vZGVzKCkge1xuICAgICAgICAgICAgICByZXR1cm4gcHJvcChcImNvbGxlY3Rpb25cIikuZmluZE5vZGVzKGV4cGFuZGVkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KSksXG4gICAgICBzZWxlY3RlZFZhbHVlOiBiaW5kYWJsZSgoKSA9PiAoe1xuICAgICAgICBkZWZhdWx0VmFsdWU6IHByb3AoXCJkZWZhdWx0U2VsZWN0ZWRWYWx1ZVwiKSxcbiAgICAgICAgdmFsdWU6IHByb3AoXCJzZWxlY3RlZFZhbHVlXCIpLFxuICAgICAgICBpc0VxdWFsLFxuICAgICAgICBvbkNoYW5nZShzZWxlY3RlZFZhbHVlKSB7XG4gICAgICAgICAgY29uc3QgY3R4ID0gZ2V0Q29udGV4dCgpO1xuICAgICAgICAgIGNvbnN0IGZvY3VzZWRWYWx1ZSA9IGN0eC5nZXQoXCJmb2N1c2VkVmFsdWVcIik7XG4gICAgICAgICAgcHJvcChcIm9uU2VsZWN0aW9uQ2hhbmdlXCIpPy4oe1xuICAgICAgICAgICAgc2VsZWN0ZWRWYWx1ZSxcbiAgICAgICAgICAgIGZvY3VzZWRWYWx1ZSxcbiAgICAgICAgICAgIGdldCBzZWxlY3RlZE5vZGVzKCkge1xuICAgICAgICAgICAgICByZXR1cm4gcHJvcChcImNvbGxlY3Rpb25cIikuZmluZE5vZGVzKHNlbGVjdGVkVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KSksXG4gICAgICBmb2N1c2VkVmFsdWU6IGJpbmRhYmxlKCgpID0+ICh7XG4gICAgICAgIGRlZmF1bHRWYWx1ZTogcHJvcChcImRlZmF1bHRGb2N1c2VkVmFsdWVcIikgfHwgbnVsbCxcbiAgICAgICAgdmFsdWU6IHByb3AoXCJmb2N1c2VkVmFsdWVcIiksXG4gICAgICAgIG9uQ2hhbmdlKGZvY3VzZWRWYWx1ZSkge1xuICAgICAgICAgIHByb3AoXCJvbkZvY3VzQ2hhbmdlXCIpPy4oe1xuICAgICAgICAgICAgZm9jdXNlZFZhbHVlLFxuICAgICAgICAgICAgZ2V0IGZvY3VzZWROb2RlKCkge1xuICAgICAgICAgICAgICByZXR1cm4gZm9jdXNlZFZhbHVlID8gcHJvcChcImNvbGxlY3Rpb25cIikuZmluZE5vZGUoZm9jdXNlZFZhbHVlKSA6IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pKSxcbiAgICAgIGxvYWRpbmdTdGF0dXM6IGJpbmRhYmxlKCgpID0+ICh7XG4gICAgICAgIGRlZmF1bHRWYWx1ZToge31cbiAgICAgIH0pKSxcbiAgICAgIGNoZWNrZWRWYWx1ZTogYmluZGFibGUoKCkgPT4gKHtcbiAgICAgICAgZGVmYXVsdFZhbHVlOiBwcm9wKFwiZGVmYXVsdENoZWNrZWRWYWx1ZVwiKSB8fCBbXSxcbiAgICAgICAgdmFsdWU6IHByb3AoXCJjaGVja2VkVmFsdWVcIiksXG4gICAgICAgIGlzRXF1YWwsXG4gICAgICAgIG9uQ2hhbmdlKHZhbHVlKSB7XG4gICAgICAgICAgcHJvcChcIm9uQ2hlY2tlZENoYW5nZVwiKT8uKHsgY2hlY2tlZFZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgfSkpXG4gICAgfTtcbiAgfSxcbiAgcmVmcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZWFoZWFkU3RhdGU6IHsgLi4uZ2V0QnlUeXBlYWhlYWQuZGVmYXVsdE9wdGlvbnMgfSxcbiAgICAgIHBlbmRpbmdBYm9ydHM6IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKClcbiAgICB9O1xuICB9LFxuICBjb21wdXRlZDoge1xuICAgIGlzTXVsdGlwbGVTZWxlY3Rpb246ICh7IHByb3AgfSkgPT4gcHJvcChcInNlbGVjdGlvbk1vZGVcIikgPT09IFwibXVsdGlwbGVcIixcbiAgICBpc1R5cGluZ0FoZWFkOiAoeyByZWZzIH0pID0+IHJlZnMuZ2V0KFwidHlwZWFoZWFkU3RhdGVcIikua2V5c1NvRmFyLmxlbmd0aCA+IDAsXG4gICAgdmlzaWJsZU5vZGVzOiAoeyBwcm9wLCBjb250ZXh0IH0pID0+IHtcbiAgICAgIGNvbnN0IG5vZGVzID0gW107XG4gICAgICBwcm9wKFwiY29sbGVjdGlvblwiKS52aXNpdCh7XG4gICAgICAgIHNraXA6IHNraXBGbih7IHByb3AsIGNvbnRleHQgfSksXG4gICAgICAgIG9uRW50ZXI6IChub2RlLCBpbmRleFBhdGgpID0+IHtcbiAgICAgICAgICBub2Rlcy5wdXNoKHsgbm9kZSwgaW5kZXhQYXRoIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gIH0sXG4gIG9uOiB7XG4gICAgXCJFWFBBTkRFRC5TRVRcIjoge1xuICAgICAgYWN0aW9uczogW1wic2V0RXhwYW5kZWRcIl1cbiAgICB9LFxuICAgIFwiRVhQQU5ERUQuQ0xFQVJcIjoge1xuICAgICAgYWN0aW9uczogW1wiY2xlYXJFeHBhbmRlZFwiXVxuICAgIH0sXG4gICAgXCJFWFBBTkRFRC5BTExcIjoge1xuICAgICAgYWN0aW9uczogW1wiZXhwYW5kQWxsQnJhbmNoZXNcIl1cbiAgICB9LFxuICAgIFwiQlJBTkNILkVYUEFORFwiOiB7XG4gICAgICBhY3Rpb25zOiBbXCJleHBhbmRCcmFuY2hlc1wiXVxuICAgIH0sXG4gICAgXCJCUkFOQ0guQ09MTEFQU0VcIjoge1xuICAgICAgYWN0aW9uczogW1wiY29sbGFwc2VCcmFuY2hlc1wiXVxuICAgIH0sXG4gICAgXCJTRUxFQ1RFRC5TRVRcIjoge1xuICAgICAgYWN0aW9uczogW1wic2V0U2VsZWN0ZWRcIl1cbiAgICB9LFxuICAgIFwiU0VMRUNURUQuQUxMXCI6IFtcbiAgICAgIHtcbiAgICAgICAgZ3VhcmQ6IGFuZChcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiwgXCJtb3ZlRm9jdXNcIiksXG4gICAgICAgIGFjdGlvbnM6IFtcInNlbGVjdEFsbE5vZGVzXCIsIFwiZm9jdXNUcmVlTGFzdE5vZGVcIl1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGd1YXJkOiBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIixcbiAgICAgICAgYWN0aW9uczogW1wic2VsZWN0QWxsTm9kZXNcIl1cbiAgICAgIH1cbiAgICBdLFxuICAgIFwiU0VMRUNURUQuQ0xFQVJcIjoge1xuICAgICAgYWN0aW9uczogW1wiY2xlYXJTZWxlY3RlZFwiXVxuICAgIH0sXG4gICAgXCJOT0RFLlNFTEVDVFwiOiB7XG4gICAgICBhY3Rpb25zOiBbXCJzZWxlY3ROb2RlXCJdXG4gICAgfSxcbiAgICBcIk5PREUuREVTRUxFQ1RcIjoge1xuICAgICAgYWN0aW9uczogW1wiZGVzZWxlY3ROb2RlXCJdXG4gICAgfSxcbiAgICBcIkNIRUNLRUQuVE9HR0xFXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcInRvZ2dsZUNoZWNrZWRcIl1cbiAgICB9LFxuICAgIFwiQ0hFQ0tFRC5TRVRcIjoge1xuICAgICAgYWN0aW9uczogW1wic2V0Q2hlY2tlZFwiXVxuICAgIH0sXG4gICAgXCJDSEVDS0VELkNMRUFSXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImNsZWFyQ2hlY2tlZFwiXVxuICAgIH1cbiAgfSxcbiAgZXhpdDogW1wiY2xlYXJQZW5kaW5nQWJvcnRzXCJdLFxuICBzdGF0ZXM6IHtcbiAgICBpZGxlOiB7XG4gICAgICBvbjoge1xuICAgICAgICBcIk5PREUuRk9DVVNcIjoge1xuICAgICAgICAgIGFjdGlvbnM6IFtcInNldEZvY3VzZWROb2RlXCJdXG4gICAgICAgIH0sXG4gICAgICAgIFwiTk9ERS5BUlJPV19ET1dOXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNTaGlmdEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c1RyZWVOZXh0Tm9kZVwiLCBcImV4dGVuZFNlbGVjdGlvblRvTmV4dE5vZGVcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzVHJlZU5leHROb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIk5PREUuQVJST1dfVVBcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc1NoaWZ0S2V5XCIsIFwiaXNNdWx0aXBsZVNlbGVjdGlvblwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzVHJlZVByZXZOb2RlXCIsIFwiZXh0ZW5kU2VsZWN0aW9uVG9QcmV2Tm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNUcmVlUHJldk5vZGVcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiTk9ERS5BUlJPV19MRUZUXCI6IHtcbiAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c0JyYW5jaE5vZGVcIl1cbiAgICAgICAgfSxcbiAgICAgICAgXCJCUkFOQ0hfTk9ERS5BUlJPV19MRUZUXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogXCJpc0JyYW5jaEV4cGFuZGVkXCIsXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJjb2xsYXBzZUJyYW5jaFwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNCcmFuY2hOb2RlXCJdXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICBcIkJSQU5DSF9OT0RFLkFSUk9XX1JJR0hUXCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNCcmFuY2hGb2N1c2VkXCIsIFwiaXNCcmFuY2hFeHBhbmRlZFwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzQnJhbmNoRmlyc3ROb2RlXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJleHBhbmRCcmFuY2hcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiU0lCTElOR1MuRVhQQU5EXCI6IHtcbiAgICAgICAgICBhY3Rpb25zOiBbXCJleHBhbmRTaWJsaW5nQnJhbmNoZXNcIl1cbiAgICAgICAgfSxcbiAgICAgICAgXCJOT0RFLkhPTUVcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc1NoaWZ0S2V5XCIsIFwiaXNNdWx0aXBsZVNlbGVjdGlvblwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImV4dGVuZFNlbGVjdGlvblRvRmlyc3ROb2RlXCIsIFwiZm9jdXNUcmVlRmlyc3ROb2RlXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJmb2N1c1RyZWVGaXJzdE5vZGVcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiTk9ERS5FTkRcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc1NoaWZ0S2V5XCIsIFwiaXNNdWx0aXBsZVNlbGVjdGlvblwiKSxcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcImV4dGVuZFNlbGVjdGlvblRvTGFzdE5vZGVcIiwgXCJmb2N1c1RyZWVMYXN0Tm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wiZm9jdXNUcmVlTGFzdE5vZGVcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiTk9ERS5DTElDS1wiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IGFuZChcImlzQ3RybEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJ0b2dnbGVOb2RlU2VsZWN0aW9uXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogYW5kKFwiaXNTaGlmdEtleVwiLCBcImlzTXVsdGlwbGVTZWxlY3Rpb25cIiksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJleHRlbmRTZWxlY3Rpb25Ub05vZGVcIl1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtcInNlbGVjdE5vZGVcIl1cbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwiQlJBTkNIX05PREUuQ0xJQ0tcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGd1YXJkOiBhbmQoXCJpc0N0cmxLZXlcIiwgXCJpc011bHRpcGxlU2VsZWN0aW9uXCIpLFxuICAgICAgICAgICAgYWN0aW9uczogW1widG9nZ2xlTm9kZVNlbGVjdGlvblwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZ3VhcmQ6IGFuZChcImlzU2hpZnRLZXlcIiwgXCJpc011bHRpcGxlU2VsZWN0aW9uXCIpLFxuICAgICAgICAgICAgYWN0aW9uczogW1wiZXh0ZW5kU2VsZWN0aW9uVG9Ob2RlXCJdXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBndWFyZDogXCJleHBhbmRPbkNsaWNrXCIsXG4gICAgICAgICAgICBhY3Rpb25zOiBbXCJzZWxlY3ROb2RlXCIsIFwidG9nZ2xlQnJhbmNoTm9kZVwiXVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYWN0aW9uczogW1wic2VsZWN0Tm9kZVwiXVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJCUkFOQ0hfVE9HR0xFLkNMSUNLXCI6IHtcbiAgICAgICAgICBhY3Rpb25zOiBbXCJ0b2dnbGVCcmFuY2hOb2RlXCJdXG4gICAgICAgIH0sXG4gICAgICAgIFwiVFJFRS5UWVBFQUhFQURcIjoge1xuICAgICAgICAgIGFjdGlvbnM6IFtcImZvY3VzTWF0Y2hlZE5vZGVcIl1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgaW1wbGVtZW50YXRpb25zOiB7XG4gICAgZ3VhcmRzOiB7XG4gICAgICBpc0JyYW5jaEZvY3VzZWQ6ICh7IGNvbnRleHQsIGV2ZW50IH0pID0+IGNvbnRleHQuZ2V0KFwiZm9jdXNlZFZhbHVlXCIpID09PSBldmVudC5pZCxcbiAgICAgIGlzQnJhbmNoRXhwYW5kZWQ6ICh7IGNvbnRleHQsIGV2ZW50IH0pID0+IGNvbnRleHQuZ2V0KFwiZXhwYW5kZWRWYWx1ZVwiKS5pbmNsdWRlcyhldmVudC5pZCksXG4gICAgICBpc1NoaWZ0S2V5OiAoeyBldmVudCB9KSA9PiBldmVudC5zaGlmdEtleSxcbiAgICAgIGlzQ3RybEtleTogKHsgZXZlbnQgfSkgPT4gZXZlbnQuY3RybEtleSxcbiAgICAgIGhhc1NlbGVjdGVkSXRlbXM6ICh7IGNvbnRleHQgfSkgPT4gY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpLmxlbmd0aCA+IDAsXG4gICAgICBpc011bHRpcGxlU2VsZWN0aW9uOiAoeyBwcm9wIH0pID0+IHByb3AoXCJzZWxlY3Rpb25Nb2RlXCIpID09PSBcIm11bHRpcGxlXCIsXG4gICAgICBtb3ZlRm9jdXM6ICh7IGV2ZW50IH0pID0+ICEhZXZlbnQubW92ZUZvY3VzLFxuICAgICAgZXhwYW5kT25DbGljazogKHsgcHJvcCB9KSA9PiAhIXByb3AoXCJleHBhbmRPbkNsaWNrXCIpXG4gICAgfSxcbiAgICBhY3Rpb25zOiB7XG4gICAgICBzZWxlY3ROb2RlKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGV2ZW50LmlkIHx8IGV2ZW50LnZhbHVlO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgKHByZXYpID0+IHtcbiAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIHByZXY7XG4gICAgICAgICAgaWYgKCFldmVudC5pc1RydXN0ZWQgJiYgaXNBcnJheSh2YWx1ZSkpIHJldHVybiBwcmV2LmNvbmNhdCguLi52YWx1ZSk7XG4gICAgICAgICAgcmV0dXJuIFtpc0FycmF5KHZhbHVlKSA/IGxhc3QodmFsdWUpIDogdmFsdWVdLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZGVzZWxlY3ROb2RlKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHRvQXJyYXkoZXZlbnQuaWQgfHwgZXZlbnQudmFsdWUpO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgKHByZXYpID0+IHJlbW92ZShwcmV2LCAuLi52YWx1ZSkpO1xuICAgICAgfSxcbiAgICAgIHNldEZvY3VzZWROb2RlKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcImZvY3VzZWRWYWx1ZVwiLCBldmVudC5pZCk7XG4gICAgICB9LFxuICAgICAgY2xlYXJGb2N1c2VkTm9kZSh7IGNvbnRleHQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcImZvY3VzZWRWYWx1ZVwiLCBudWxsKTtcbiAgICAgIH0sXG4gICAgICBjbGVhclNlbGVjdGVkSXRlbSh7IGNvbnRleHQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgW10pO1xuICAgICAgfSxcbiAgICAgIHRvZ2dsZUJyYW5jaE5vZGUoeyBjb250ZXh0LCBldmVudCwgYWN0aW9uIH0pIHtcbiAgICAgICAgY29uc3QgaXNFeHBhbmRlZCA9IGNvbnRleHQuZ2V0KFwiZXhwYW5kZWRWYWx1ZVwiKS5pbmNsdWRlcyhldmVudC5pZCk7XG4gICAgICAgIGFjdGlvbihpc0V4cGFuZGVkID8gW1wiY29sbGFwc2VCcmFuY2hcIl0gOiBbXCJleHBhbmRCcmFuY2hcIl0pO1xuICAgICAgfSxcbiAgICAgIGV4cGFuZEJyYW5jaChwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBldmVudCB9ID0gcGFyYW1zO1xuICAgICAgICBleHBhbmRCcmFuY2hlcyhwYXJhbXMsIFtldmVudC5pZF0pO1xuICAgICAgfSxcbiAgICAgIGV4cGFuZEJyYW5jaGVzKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGNvbnRleHQsIGV2ZW50IH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IHZhbHVlc1RvRXhwYW5kID0gdG9BcnJheShldmVudC52YWx1ZSk7XG4gICAgICAgIGV4cGFuZEJyYW5jaGVzKHBhcmFtcywgZGlmZih2YWx1ZXNUb0V4cGFuZCwgY29udGV4dC5nZXQoXCJleHBhbmRlZFZhbHVlXCIpKSk7XG4gICAgICB9LFxuICAgICAgY29sbGFwc2VCcmFuY2goeyBjb250ZXh0LCBldmVudCB9KSB7XG4gICAgICAgIGNvbnRleHQuc2V0KFwiZXhwYW5kZWRWYWx1ZVwiLCAocHJldikgPT4gcmVtb3ZlKHByZXYsIGV2ZW50LmlkKSk7XG4gICAgICB9LFxuICAgICAgY29sbGFwc2VCcmFuY2hlcyhwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBldmVudCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHRvQXJyYXkoZXZlbnQudmFsdWUpO1xuICAgICAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgKHByZXYpID0+IHJlbW92ZShwcmV2LCAuLi52YWx1ZSkpO1xuICAgICAgfSxcbiAgICAgIHNldEV4cGFuZGVkKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBpZiAoIWlzQXJyYXkoZXZlbnQudmFsdWUpKSByZXR1cm47XG4gICAgICAgIGNvbnRleHQuc2V0KFwiZXhwYW5kZWRWYWx1ZVwiLCBldmVudC52YWx1ZSk7XG4gICAgICB9LFxuICAgICAgY2xlYXJFeHBhbmRlZCh7IGNvbnRleHQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcImV4cGFuZGVkVmFsdWVcIiwgW10pO1xuICAgICAgfSxcbiAgICAgIHNldFNlbGVjdGVkKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBpZiAoIWlzQXJyYXkoZXZlbnQudmFsdWUpKSByZXR1cm47XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCBldmVudC52YWx1ZSk7XG4gICAgICB9LFxuICAgICAgY2xlYXJTZWxlY3RlZCh7IGNvbnRleHQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgW10pO1xuICAgICAgfSxcbiAgICAgIGZvY3VzVHJlZUZpcnN0Tm9kZSh7IHByb3AsIHNjb3BlIH0pIHtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgZmlyc3ROb2RlID0gY29sbGVjdGlvbjIuZ2V0Rmlyc3ROb2RlKCk7XG4gICAgICAgIGNvbnN0IGZpcnN0VmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUoZmlyc3ROb2RlKTtcbiAgICAgICAgZm9jdXNOb2RlKHNjb3BlLCBmaXJzdFZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBmb2N1c1RyZWVMYXN0Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBwcm9wLCBzY29wZSB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBsYXN0Tm9kZSA9IGNvbGxlY3Rpb24yLmdldExhc3ROb2RlKHZvaWQgMCwgeyBza2lwOiBza2lwRm4ocGFyYW1zKSB9KTtcbiAgICAgICAgY29uc3QgbGFzdFZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKGxhc3ROb2RlKTtcbiAgICAgICAgZm9jdXNOb2RlKHNjb3BlLCBsYXN0VmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGZvY3VzQnJhbmNoRmlyc3ROb2RlKHsgZXZlbnQsIHByb3AsIHNjb3BlIH0pIHtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgYnJhbmNoTm9kZSA9IGNvbGxlY3Rpb24yLmZpbmROb2RlKGV2ZW50LmlkKTtcbiAgICAgICAgY29uc3QgZmlyc3ROb2RlID0gY29sbGVjdGlvbjIuZ2V0Rmlyc3ROb2RlKGJyYW5jaE5vZGUpO1xuICAgICAgICBjb25zdCBmaXJzdFZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKGZpcnN0Tm9kZSk7XG4gICAgICAgIGZvY3VzTm9kZShzY29wZSwgZmlyc3RWYWx1ZSk7XG4gICAgICB9LFxuICAgICAgZm9jdXNUcmVlTmV4dE5vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgZXZlbnQsIHByb3AsIHNjb3BlIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IG5leHROb2RlID0gY29sbGVjdGlvbjIuZ2V0TmV4dE5vZGUoZXZlbnQuaWQsIHsgc2tpcDogc2tpcEZuKHBhcmFtcykgfSk7XG4gICAgICAgIGlmICghbmV4dE5vZGUpIHJldHVybjtcbiAgICAgICAgY29uc3QgbmV4dFZhbHVlID0gY29sbGVjdGlvbjIuZ2V0Tm9kZVZhbHVlKG5leHROb2RlKTtcbiAgICAgICAgZm9jdXNOb2RlKHNjb3BlLCBuZXh0VmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGZvY3VzVHJlZVByZXZOb2RlKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGV2ZW50LCBwcm9wLCBzY29wZSB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBwcmV2Tm9kZSA9IGNvbGxlY3Rpb24yLmdldFByZXZpb3VzTm9kZShldmVudC5pZCwgeyBza2lwOiBza2lwRm4ocGFyYW1zKSB9KTtcbiAgICAgICAgaWYgKCFwcmV2Tm9kZSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBwcmV2VmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUocHJldk5vZGUpO1xuICAgICAgICBmb2N1c05vZGUoc2NvcGUsIHByZXZWYWx1ZSk7XG4gICAgICB9LFxuICAgICAgZm9jdXNCcmFuY2hOb2RlKHsgZXZlbnQsIHByb3AsIHNjb3BlIH0pIHtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGNvbGxlY3Rpb24yLmdldFBhcmVudE5vZGUoZXZlbnQuaWQpO1xuICAgICAgICBjb25zdCBwYXJlbnRWYWx1ZSA9IHBhcmVudE5vZGUgPyBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUocGFyZW50Tm9kZSkgOiB2b2lkIDA7XG4gICAgICAgIGZvY3VzTm9kZShzY29wZSwgcGFyZW50VmFsdWUpO1xuICAgICAgfSxcbiAgICAgIHNlbGVjdEFsbE5vZGVzKHsgY29udGV4dCwgcHJvcCB9KSB7XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCBwcm9wKFwiY29sbGVjdGlvblwiKS5nZXRWYWx1ZXMoKSk7XG4gICAgICB9LFxuICAgICAgZm9jdXNNYXRjaGVkTm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBwcm9wLCByZWZzLCBldmVudCwgc2NvcGUsIGNvbXB1dGVkIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gY29tcHV0ZWQoXCJ2aXNpYmxlTm9kZXNcIik7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRzID0gbm9kZXMubWFwKCh7IG5vZGU6IG5vZGUyIH0pID0+ICh7XG4gICAgICAgICAgdGV4dENvbnRlbnQ6IHByb3AoXCJjb2xsZWN0aW9uXCIpLnN0cmluZ2lmeU5vZGUobm9kZTIpLFxuICAgICAgICAgIGlkOiBwcm9wKFwiY29sbGVjdGlvblwiKS5nZXROb2RlVmFsdWUobm9kZTIpXG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3Qgbm9kZSA9IGdldEJ5VHlwZWFoZWFkKGVsZW1lbnRzLCB7XG4gICAgICAgICAgc3RhdGU6IHJlZnMuZ2V0KFwidHlwZWFoZWFkU3RhdGVcIiksXG4gICAgICAgICAgYWN0aXZlSWQ6IGNvbnRleHQuZ2V0KFwiZm9jdXNlZFZhbHVlXCIpLFxuICAgICAgICAgIGtleTogZXZlbnQua2V5XG4gICAgICAgIH0pO1xuICAgICAgICBmb2N1c05vZGUoc2NvcGUsIG5vZGU/LmlkKTtcbiAgICAgIH0sXG4gICAgICB0b2dnbGVOb2RlU2VsZWN0aW9uKHsgY29udGV4dCwgZXZlbnQgfSkge1xuICAgICAgICBjb25zdCBzZWxlY3RlZFZhbHVlID0gYWRkT3JSZW1vdmUoY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpLCBldmVudC5pZCk7XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCBzZWxlY3RlZFZhbHVlKTtcbiAgICAgIH0sXG4gICAgICBleHBhbmRBbGxCcmFuY2hlcyhwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBwcm9wIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGJyYW5jaFZhbHVlcyA9IHByb3AoXCJjb2xsZWN0aW9uXCIpLmdldEJyYW5jaFZhbHVlcygpO1xuICAgICAgICBjb25zdCB2YWx1ZXNUb0V4cGFuZCA9IGRpZmYoYnJhbmNoVmFsdWVzLCBjb250ZXh0LmdldChcImV4cGFuZGVkVmFsdWVcIikpO1xuICAgICAgICBleHBhbmRCcmFuY2hlcyhwYXJhbXMsIHZhbHVlc1RvRXhwYW5kKTtcbiAgICAgIH0sXG4gICAgICBleHBhbmRTaWJsaW5nQnJhbmNoZXMocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgZXZlbnQsIHByb3AgfSA9IHBhcmFtcztcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbjIgPSBwcm9wKFwiY29sbGVjdGlvblwiKTtcbiAgICAgICAgY29uc3QgaW5kZXhQYXRoID0gY29sbGVjdGlvbjIuZ2V0SW5kZXhQYXRoKGV2ZW50LmlkKTtcbiAgICAgICAgaWYgKCFpbmRleFBhdGgpIHJldHVybjtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBjb2xsZWN0aW9uMi5nZXRTaWJsaW5nTm9kZXMoaW5kZXhQYXRoKTtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gbm9kZXMubWFwKChub2RlKSA9PiBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSkpO1xuICAgICAgICBjb25zdCB2YWx1ZXNUb0V4cGFuZCA9IGRpZmYodmFsdWVzLCBjb250ZXh0LmdldChcImV4cGFuZGVkVmFsdWVcIikpO1xuICAgICAgICBleHBhbmRCcmFuY2hlcyhwYXJhbXMsIHZhbHVlc1RvRXhwYW5kKTtcbiAgICAgIH0sXG4gICAgICBleHRlbmRTZWxlY3Rpb25Ub05vZGUocGFyYW1zKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGV4dCwgZXZlbnQsIHByb3AsIGNvbXB1dGVkIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGFuY2hvclZhbHVlID0gZmlyc3QoY29udGV4dC5nZXQoXCJzZWxlY3RlZFZhbHVlXCIpKSB8fCBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUoY29sbGVjdGlvbjIuZ2V0Rmlyc3ROb2RlKCkpO1xuICAgICAgICBjb25zdCB0YXJnZXRWYWx1ZSA9IGV2ZW50LmlkO1xuICAgICAgICBsZXQgdmFsdWVzID0gW2FuY2hvclZhbHVlLCB0YXJnZXRWYWx1ZV07XG4gICAgICAgIGxldCBoaXRzID0gMDtcbiAgICAgICAgY29uc3QgdmlzaWJsZU5vZGVzID0gY29tcHV0ZWQoXCJ2aXNpYmxlTm9kZXNcIik7XG4gICAgICAgIHZpc2libGVOb2Rlcy5mb3JFYWNoKCh7IG5vZGUgfSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG5vZGVWYWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShub2RlKTtcbiAgICAgICAgICBpZiAoaGl0cyA9PT0gMSkgdmFsdWVzLnB1c2gobm9kZVZhbHVlKTtcbiAgICAgICAgICBpZiAobm9kZVZhbHVlID09PSBhbmNob3JWYWx1ZSB8fCBub2RlVmFsdWUgPT09IHRhcmdldFZhbHVlKSBoaXRzKys7XG4gICAgICAgIH0pO1xuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgdW5pcSh2YWx1ZXMpKTtcbiAgICAgIH0sXG4gICAgICBleHRlbmRTZWxlY3Rpb25Ub05leHROb2RlKHBhcmFtcykge1xuICAgICAgICBjb25zdCB7IGNvbnRleHQsIGV2ZW50LCBwcm9wIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IG5leHROb2RlID0gY29sbGVjdGlvbjIuZ2V0TmV4dE5vZGUoZXZlbnQuaWQsIHsgc2tpcDogc2tpcEZuKHBhcmFtcykgfSk7XG4gICAgICAgIGlmICghbmV4dE5vZGUpIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWVzID0gbmV3IFNldChjb250ZXh0LmdldChcInNlbGVjdGVkVmFsdWVcIikpO1xuICAgICAgICBjb25zdCBuZXh0VmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobmV4dE5vZGUpO1xuICAgICAgICBpZiAobmV4dFZhbHVlID09IG51bGwpIHJldHVybjtcbiAgICAgICAgaWYgKHZhbHVlcy5oYXMoZXZlbnQuaWQpICYmIHZhbHVlcy5oYXMobmV4dFZhbHVlKSkge1xuICAgICAgICAgIHZhbHVlcy5kZWxldGUoZXZlbnQuaWQpO1xuICAgICAgICB9IGVsc2UgaWYgKCF2YWx1ZXMuaGFzKG5leHRWYWx1ZSkpIHtcbiAgICAgICAgICB2YWx1ZXMuYWRkKG5leHRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIEFycmF5LmZyb20odmFsdWVzKSk7XG4gICAgICB9LFxuICAgICAgZXh0ZW5kU2VsZWN0aW9uVG9QcmV2Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBldmVudCwgcHJvcCB9ID0gcGFyYW1zO1xuICAgICAgICBjb25zdCBjb2xsZWN0aW9uMiA9IHByb3AoXCJjb2xsZWN0aW9uXCIpO1xuICAgICAgICBjb25zdCBwcmV2Tm9kZSA9IGNvbGxlY3Rpb24yLmdldFByZXZpb3VzTm9kZShldmVudC5pZCwgeyBza2lwOiBza2lwRm4ocGFyYW1zKSB9KTtcbiAgICAgICAgaWYgKCFwcmV2Tm9kZSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBuZXcgU2V0KGNvbnRleHQuZ2V0KFwic2VsZWN0ZWRWYWx1ZVwiKSk7XG4gICAgICAgIGNvbnN0IHByZXZWYWx1ZSA9IGNvbGxlY3Rpb24yLmdldE5vZGVWYWx1ZShwcmV2Tm9kZSk7XG4gICAgICAgIGlmIChwcmV2VmFsdWUgPT0gbnVsbCkgcmV0dXJuO1xuICAgICAgICBpZiAodmFsdWVzLmhhcyhldmVudC5pZCkgJiYgdmFsdWVzLmhhcyhwcmV2VmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWVzLmRlbGV0ZShldmVudC5pZCk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXZhbHVlcy5oYXMocHJldlZhbHVlKSkge1xuICAgICAgICAgIHZhbHVlcy5hZGQocHJldlZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0LnNldChcInNlbGVjdGVkVmFsdWVcIiwgQXJyYXkuZnJvbSh2YWx1ZXMpKTtcbiAgICAgIH0sXG4gICAgICBleHRlbmRTZWxlY3Rpb25Ub0ZpcnN0Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBwcm9wIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3Rpb24gPSBmaXJzdChjb250ZXh0LmdldChcInNlbGVjdGVkVmFsdWVcIikpO1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgY29sbGVjdGlvbjIudmlzaXQoe1xuICAgICAgICAgIHNraXA6IHNraXBGbihwYXJhbXMpLFxuICAgICAgICAgIG9uRW50ZXI6IChub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBub2RlVmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaChub2RlVmFsdWUpO1xuICAgICAgICAgICAgaWYgKG5vZGVWYWx1ZSA9PT0gY3VycmVudFNlbGVjdGlvbikge1xuICAgICAgICAgICAgICByZXR1cm4gXCJzdG9wXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29udGV4dC5zZXQoXCJzZWxlY3RlZFZhbHVlXCIsIHZhbHVlcyk7XG4gICAgICB9LFxuICAgICAgZXh0ZW5kU2VsZWN0aW9uVG9MYXN0Tm9kZShwYXJhbXMpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0LCBwcm9wIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWxlY3Rpb24gPSBmaXJzdChjb250ZXh0LmdldChcInNlbGVjdGVkVmFsdWVcIikpO1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgbGV0IGN1cnJlbnQgPSBmYWxzZTtcbiAgICAgICAgY29sbGVjdGlvbjIudmlzaXQoe1xuICAgICAgICAgIHNraXA6IHNraXBGbihwYXJhbXMpLFxuICAgICAgICAgIG9uRW50ZXI6IChub2RlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBub2RlVmFsdWUgPSBjb2xsZWN0aW9uMi5nZXROb2RlVmFsdWUobm9kZSk7XG4gICAgICAgICAgICBpZiAobm9kZVZhbHVlID09PSBjdXJyZW50U2VsZWN0aW9uKSBjdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50KSB2YWx1ZXMucHVzaChub2RlVmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRleHQuc2V0KFwic2VsZWN0ZWRWYWx1ZVwiLCB2YWx1ZXMpO1xuICAgICAgfSxcbiAgICAgIGNsZWFyUGVuZGluZ0Fib3J0cyh7IHJlZnMgfSkge1xuICAgICAgICBjb25zdCBhYm9ydHMgPSByZWZzLmdldChcInBlbmRpbmdBYm9ydHNcIik7XG4gICAgICAgIGFib3J0cy5mb3JFYWNoKChhYm9ydCkgPT4gYWJvcnQuYWJvcnQoKSk7XG4gICAgICAgIGFib3J0cy5jbGVhcigpO1xuICAgICAgfSxcbiAgICAgIHRvZ2dsZUNoZWNrZWQoeyBjb250ZXh0LCBldmVudCwgcHJvcCB9KSB7XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb24yID0gcHJvcChcImNvbGxlY3Rpb25cIik7XG4gICAgICAgIGNvbnRleHQuc2V0KFxuICAgICAgICAgIFwiY2hlY2tlZFZhbHVlXCIsXG4gICAgICAgICAgKHByZXYpID0+IGV2ZW50LmlzQnJhbmNoID8gdG9nZ2xlQnJhbmNoQ2hlY2tlZChjb2xsZWN0aW9uMiwgZXZlbnQudmFsdWUsIHByZXYpIDogYWRkT3JSZW1vdmUocHJldiwgZXZlbnQudmFsdWUpXG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICAgc2V0Q2hlY2tlZCh7IGNvbnRleHQsIGV2ZW50IH0pIHtcbiAgICAgICAgY29udGV4dC5zZXQoXCJjaGVja2VkVmFsdWVcIiwgZXZlbnQudmFsdWUpO1xuICAgICAgfSxcbiAgICAgIGNsZWFyQ2hlY2tlZCh7IGNvbnRleHQgfSkge1xuICAgICAgICBjb250ZXh0LnNldChcImNoZWNrZWRWYWx1ZVwiLCBbXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59KTtcbnZhciBwcm9wcyA9IGNyZWF0ZVByb3BzKCkoW1xuICBcImlkc1wiLFxuICBcImNvbGxlY3Rpb25cIixcbiAgXCJkaXJcIixcbiAgXCJleHBhbmRlZFZhbHVlXCIsXG4gIFwiZXhwYW5kT25DbGlja1wiLFxuICBcImRlZmF1bHRGb2N1c2VkVmFsdWVcIixcbiAgXCJmb2N1c2VkVmFsdWVcIixcbiAgXCJnZXRSb290Tm9kZVwiLFxuICBcImlkXCIsXG4gIFwib25FeHBhbmRlZENoYW5nZVwiLFxuICBcIm9uRm9jdXNDaGFuZ2VcIixcbiAgXCJvblNlbGVjdGlvbkNoYW5nZVwiLFxuICBcImNoZWNrZWRWYWx1ZVwiLFxuICBcInNlbGVjdGVkVmFsdWVcIixcbiAgXCJzZWxlY3Rpb25Nb2RlXCIsXG4gIFwidHlwZWFoZWFkXCIsXG4gIFwiZGVmYXVsdEV4cGFuZGVkVmFsdWVcIixcbiAgXCJkZWZhdWx0U2VsZWN0ZWRWYWx1ZVwiLFxuICBcImRlZmF1bHRDaGVja2VkVmFsdWVcIixcbiAgXCJvbkNoZWNrZWRDaGFuZ2VcIixcbiAgXCJvbkxvYWRDaGlsZHJlbkNvbXBsZXRlXCIsXG4gIFwib25Mb2FkQ2hpbGRyZW5FcnJvclwiLFxuICBcImxvYWRDaGlsZHJlblwiXG5dKTtcbnZhciBzcGxpdFByb3BzID0gY3JlYXRlU3BsaXRQcm9wcyhwcm9wcyk7XG52YXIgaXRlbVByb3BzID0gY3JlYXRlUHJvcHMoKShbXCJub2RlXCIsIFwiaW5kZXhQYXRoXCJdKTtcbnZhciBzcGxpdEl0ZW1Qcm9wcyA9IGNyZWF0ZVNwbGl0UHJvcHMoaXRlbVByb3BzKTtcblxuZXhwb3J0IHsgYW5hdG9teSwgY29sbGVjdGlvbiwgY29ubmVjdCwgZmlsZVBhdGhDb2xsZWN0aW9uLCBpdGVtUHJvcHMsIG1hY2hpbmUsIHByb3BzLCBzcGxpdEl0ZW1Qcm9wcywgc3BsaXRQcm9wcyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/@zag-js+tree-view@1.18.2/node_modules/@zag-js/tree-view/dist/index.mjs\n");

/***/ })

};
;